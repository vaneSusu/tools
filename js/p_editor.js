"use strict";(self.webpackChunkfabritor_web=self.webpackChunkfabritor_web||[]).push([[605],{3533:function(e,t,n){n.r(t),n.d(t,{default:function(){return nV}});var r,i=n(7776),o=n(8177),a=n(4758),l=n(9938),s=n(959),c=n(419),h=n(9190),u=n(3462),d=n(8173),f=n(9529),v=n(5335),p=n(7646),g=n(6333),m=n(7141),b=n(268),y=n(6538),Z=n(2642),w=n(2954);function k(e){var t=e.children;return(0,i.tZ)(w.Z,{children:t})}var x=[{label:(0,i.tZ)("div",{style:{fontSize:30,fontFamily:"\u80E1\u6653\u6CE2\u7537\u795E\u4F53",fontWeight:"bold"},children:"\u6DFB\u52A0\u6807\u9898"}),key:"title",config:{fontFamily:"\u80E1\u6653\u6CE2\u7537\u795E\u4F53",fontWeight:"bold",fontSize:120,text:"\u6DFB\u52A0\u6807\u9898",top:100}},{label:(0,i.tZ)("div",{style:{fontSize:24,fontFamily:"AlibabaPuHuiTi"},children:"\u6DFB\u52A0\u526F\u6807\u9898"}),key:"sub-title",config:{fontFamily:"AlibabaPuHuiTi",fontWeight:"bold",fontSize:100,text:"\u6DFB\u52A0\u526F\u6807\u9898",top:400}},{label:(0,i.tZ)("div",{style:{fontSize:16,fontFamily:"SourceHanSerif"},children:"\u6DFB\u52A0\u4E00\u6BB5\u6B63\u6587"}),key:"content",config:{fontFamily:"SourceHanSerif",fontSize:80,text:"\u6DFB\u52A0\u4E00\u6BB5\u6B63\u6587"}},{label:(0,i.tZ)("div",{style:{fontSize:26,fontFamily:"\u971E\u9E5C\u6587\u6977",color:"#ffffff",WebkitTextStroke:"1px rgb(255, 87, 87)"},children:"\u6587\u5B57\u8FB9\u6846"}),key:"content",config:{fontFamily:"\u971E\u9E5C\u6587\u6977",fontSize:100,text:"\u971E\u9E5C\u6587\u6977",fill:"#ffffff",stroke:"#ff5757",strokeWidth:12}}];function C(e){var t=e.addTextBox,n=function(e){null==t||t(e.config)};return(0,i.BX)(u.Z,{vertical:!0,gap:8,style:{marginTop:16},children:[(0,i.tZ)(k,{children:"\u9ED8\u8BA4\u6587\u5B57\u6837\u5F0F"}),x.map(function(e){return(0,i.tZ)(Z.Z,{hoverable:!0,onClick:function(){n(e)},bodyStyle:{padding:"12px 30px"},children:e.label},e.key)})]})}var _=n(6521);function S(){var e,t=(e=(0,o._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,(0,_.JE)(e)];case 1:return t.sent(),[2]}})}),function(t){return e.apply(this,arguments)});return(0,i.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,i.tZ)(y.ZP,{type:"primary",block:!0,onClick:function(){t({})},size:"large",children:"\u6DFB\u52A0\u6587\u672C\u6846"}),(0,i.tZ)(C,{addTextBox:t})]})}var j=n(1228);function B(e){var t=e.list,n=void 0===t?[]:t,r=e.itemClick,o=(e.maxHeight,e.type),a=Math.ceil(n.length/2),l=[n.slice(0,a),n.slice(a)];return n.length?(0,i.tZ)(u.Z,{gap:10,wrap:"wrap",justify:"space-around",children:l.map(function(e,t){return"image"===o?(0,i.tZ)(u.Z,{vertical:!0,gap:10,children:e.map(function(e,t){return(0,i.tZ)(Z.Z,{hoverable:!0,style:{width:140,boxShadow:"none"},bodyStyle:{padding:0},bordered:!1,onClick:function(){r&&r(e)},children:(0,i.tZ)("img",{src:e.cover,style:{width:"100%",borderRadius:8}})},t)})},t):(0,i.tZ)(u.Z,{vertical:!0,gap:10,children:e.map(function(e,t){return(0,i.tZ)(Z.Z,{hoverable:!0,style:{width:140},cover:(0,i.tZ)("img",{src:e.cover}),onClick:function(){r&&r(e)},children:e.title?(0,i.tZ)(Z.Z.Meta,{description:e.title}):null},t)})},t)})}):null}var R=n(5166),z=n(8703),H=function(e){return fetch("".concat("https://pixabay.com/api/?key=41215817-69c7233a9ee7dd6034b07989b","&image_type=").concat(e,"&per_page=14")).then(function(e){return e.json()}).then(function(e){return(e.hits||[]).map(function(e){return(0,z._)((0,R._)({},e),{cover:e.webformatURL})})}).catch(function(e){console.log(e)})},L=(0,s.forwardRef)(function(e,t){var n=e.onChange,r=e.accept,o=(0,s.useRef)(null),a=(0,s.useRef)(null);return(0,s.useImperativeHandle)(t,function(){return{start:function(){var e,t;null===(t=a.current)||void 0===t||null===(e=t.click)||void 0===e||e.call(t)},reset:function(){var e,t;null===(t=o.current)||void 0===t||null===(e=t.reset)||void 0===e||e.call(t)}}}),(0,i.tZ)("form",{style:{display:"none"},ref:o,children:(0,i.tZ)("input",{type:"file",accept:r||"image/*",ref:a,onChange:function(e){var t,r;e.target.files[0]&&(n&&n(e.target.files[0]),null===(r=o.current)||void 0===r||null===(t=r.reset)||void 0===t||t.call(r))}})})});function O(e){var t=e.onChange,n=(0,s.useRef)();return(0,i.BX)("div",{children:[(0,i.tZ)(y.ZP,{type:"primary",size:"large",onClick:function(){var e,t;null===(t=n.current)||void 0===t||null===(e=t.start)||void 0===e||e.call(t)},children:"\u6DFB\u52A0\u672C\u5730\u56FE\u7247"}),(0,i.tZ)(L,{accept:"image/jpg,image/jpeg,image/png",ref:n,onChange:function(e){if("image/svg+xml"!==e.type){var n=new FileReader;n.onload=function(e){null==t||t(e.target.result)},n.readAsDataURL(e)}}})]})}var P=n(5162),M=n(5732),F=n(5495);function A(e){var t=e.onChange,n=(0,a._)((0,s.useState)(""),2),r=n[0],o=n[1];return(0,i.tZ)(P.Z,{content:(0,i.BX)(M.Z.Compact,{children:[(0,i.tZ)(F.Z,{value:r,onChange:function(e){o(e.target.value)},style:{width:260}}),(0,i.tZ)(y.ZP,{onClick:function(){r&&(null==t||t(r))},children:"\u786E\u8BA4"})]}),title:"\u8BF7\u8F93\u5165\u5730\u5740\uFF1A",trigger:"click",children:(0,i.tZ)(y.ZP,{type:"primary",size:"large",children:"\u6DFB\u52A0\u8FDC\u7A0B\u56FE\u7247"})})}function X(e){var t=e.onChange;return(0,i.BX)(u.Z,{gap:10,justify:"space-around",children:[(0,i.tZ)(O,{onChange:t}),(0,i.tZ)(A,{onChange:t})]})}function E(){var e,t=(0,a._)((0,s.useState)([]),2),n=t[0],r=t[1],c=(0,a._)((0,s.useState)([]),2),h=c[0],u=c[1],d=(0,a._)((0,s.useState)([]),2),f=d[0],v=d[1],p=(e=(0,o._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,(0,j.uE)({imageSource:e})];case 1:return t.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),g=function(e){(0,j.uE)({imageSource:e.cover})},m=function(e){return(0,i.tZ)(y.ZP,{type:"link",href:"https://pixabay.com/zh/".concat(e,"s/"),target:"_blank",children:"pixabay"})};return(0,s.useEffect)(function(){H("photo").then(r),H("illustration").then(u),H("vector").then(v)},[]),(0,i.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,i.tZ)(X,{onChange:p}),(0,i.BX)(k,{children:["\u6765\u81EA",m("vector"),"\u7684\u77E2\u91CF\u56FE"]}),(0,i.tZ)(B,{list:f,type:"image",itemClick:g}),(0,i.BX)(k,{children:["\u6765\u81EA",m("photo"),"\u7684\u56FE\u7247"]}),(0,i.tZ)(B,{list:n,type:"image",itemClick:g}),(0,i.BX)(k,{children:["\u6765\u81EA",m("illustration"),"\u7684\u63D2\u753B"]}),(0,i.tZ)(B,{list:h,type:"image",itemClick:g})]})}var T=[{key:"line",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.5" stroke-linecap="butt" fill="none"></line></svg>',options:{start:[0,0],end:[300,0],strokeWidth:4,stroke:"#000000"}},{key:"dash-line",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.5" stroke-dasharray="3,1" stroke-linecap="butt" fill="none"></line></svg>',options:{start:[0,0],end:[300,0],strokeWidth:4,strokeDashArray:[8,8],stroke:"#000000"}},{key:"arrow-line-1",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 40" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)">\n    <line x1="0" x2="51" y1="20" y2="20" stroke-linecap="butt" fill="none" strokeWidth="4" />\n    <path d="M 51 20 V 23 L 56 20 L 51 17 Z"></path></svg>',options:{start:[0,0],end:[300,0],arrow:[["M",285,0],["L",285,10],["L",300,0],["L",285,-10],["L",285,0]],strokeWidth:4,stroke:"#000000",fill:"#000000",strokeLineJoin:"round",strokeLineCap:"round",middleIndex:2,sub_type:"arrow"}},{key:"arrow-line-2",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.25" stroke-linecap="butt" fill="none"></line><g transform="translate(33)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" d="M -2.5,-1.5,-0.5,0,-2.5,1.5"></path></g></svg>',options:{path:"M0 0 L305 0L290 -10M305 0L290 10",start:[0,0],end:[300,0],arrow:[["M",285,-10],["L",300,0],["L",285,10]],strokeWidth:4,stroke:"#000000",fill:"#00000000",strokeLineJoin:"round",strokeLineCap:"round",middleIndex:1,sub_type:"arrow"}}],V=n(6853),I=function(e){return Math.PI*e/180},N=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=360/e,r=[],i=0;i<e;i++){var o=t*Math.cos(I(i*n)),a=t*Math.sin(I(i*n));r.push({x:-a,y:-o})}return r},W=[{key:"rect",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M42 6H6V42H42V6Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Rect,options:{width:200,height:200,fill:"#555555"}},{key:"rect-r",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Rect,options:{width:200,height:200,rx:20,ry:20,fill:"#555555"}},{key:"circle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="20" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Circle,options:{radius:100,fill:"#555555"}},{key:"ellipse",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="24" cy="24" rx="14" ry="20" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Ellipse,options:{rx:120,ry:200,fill:"#555555"}},{key:"triangle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M22.2692 6.98965C23.0395 5.65908 24.9565 5.65908 25.7309 6.98965L44.262 38.9979C45.0339 40.3313 44.0718 42 42.5311 42H5.4689C3.92823 42 2.96611 40.3313 3.73804 38.9979L22.2692 6.98965Z" fill="#555" stroke="#555" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',shape:V.fabric.Triangle,options:{width:200,height:180,fill:"#555555"}},{key:"right-angle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 9.1153C8 7.29468 10.2347 6.42094 11.4696 7.75874L40.9016 39.6434C42.0842 40.9246 41.1755 43 39.432 43H10C8.89543 43 8 42.1046 8 41V9.1153Z" fill="#555" stroke="#555" stroke-width="4" stroke-linecap="square" stroke-linejoin="miter"/></svg>',shape:V.fabric.Polygon,options:{points:[{x:0,y:0},{x:0,y:200},{x:200,y:200}],fill:"#555555"}},{key:"diamond",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.41421 22.5858L22.5858 5.41421C23.3668 4.63317 24.6332 4.63316 25.4142 5.41421L42.5858 22.5858C43.3668 23.3668 43.3668 24.6332 42.5858 25.4142L25.4142 42.5858C24.6332 43.3668 23.3668 43.3668 22.5858 42.5858L5.41421 25.4142C4.63317 24.6332 4.63316 23.3668 5.41421 22.5858Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:[{x:0,y:100},{x:100,y:200},{x:200,y:100},{x:100,y:0}],fill:"#555555"}},{key:"parallelgram",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M41.2796 8H15.4704C14.5956 8 13.8223 8.5685 13.5614 9.40345L4.81142 37.4035C4.40897 38.6913 5.3711 40 6.72038 40H32.5296C33.4044 40 34.1777 39.4315 34.4386 38.5965L43.1886 10.5965C43.591 9.30869 42.6289 8 41.2796 8Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:[{x:50,y:0},{x:0,y:100},{x:200,y:100},{x:250,y:0}],fill:"#555555"}},{key:"pentagon",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M25.2296 4.95843L42.8601 18.7012C43.5405 19.2316 43.8041 20.1385 43.5141 20.951L36.4739 40.6724C36.1897 41.4685 35.4357 42 34.5903 42H13.4097C12.5643 42 11.8103 41.4685 11.5261 40.6724L4.48593 20.951C4.19588 20.1385 4.45953 19.2315 5.13995 18.7012L22.7704 4.95843C23.4933 4.39496 24.5067 4.39496 25.2296 4.95843Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:N(5),fill:"#555555"}},{key:"hexagon",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23.0287 43.4604L7.02871 34.5715C6.39378 34.2188 6 33.5495 6 32.8232V15.1768C6 14.4505 6.39378 13.7812 7.02872 13.4285L23.0287 4.5396C23.6328 4.20402 24.3672 4.20402 24.9713 4.5396L40.9713 13.4285C41.6062 13.7812 42 14.4505 42 15.1768V32.8232C42 33.5495 41.6062 34.2188 40.9713 34.5715L24.9713 43.4604C24.3672 43.796 23.6328 43.796 23.0287 43.4604Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:N(6),fill:"#555555"}},{key:"octagon",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.4102 42.3887L5.56076 32.1812C5.20103 31.8083 5 31.3105 5 30.7924V17.2076C5 16.6895 5.20103 16.1917 5.56076 15.8188L15.4102 5.61126C15.7871 5.22064 16.3066 5 16.8494 5H31.1506C31.6934 5 32.2129 5.22064 32.5898 5.61126L42.4392 15.8188C42.799 16.1917 43 16.6895 43 17.2076V30.7924C43 31.3105 42.799 31.8083 42.4392 32.1812L32.5898 42.3887C32.2129 42.7794 31.6934 43 31.1506 43H16.8494C16.3066 43 15.7871 42.7794 15.4102 42.3887Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:N(8),fill:"#555555"}},{key:"trapezoid",elem:'<svg width="48" height="46" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M31.7944 8H16.2056C14.8934 8 13.7335 8.85275 13.3421 10.1052L5.21713 36.1052C4.61345 38.037 6.05665 40 8.08057 40H39.9194C41.9433 40 43.3866 38.037 42.7829 36.1052L34.6579 10.1052C34.2665 8.85275 33.1066 8 31.7944 8Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:V.fabric.Polygon,options:{points:[{x:50,y:0},{x:0,y:100},{x:200,y:100},{x:150,y:0}],fill:"#555555"}}],D=n(9517),J=n(1613),U=n(115),q=n(847),Y=function(e){var t=e||{},n=(t.left,t.top,(0,D._)(t,["left","top"])),r=(0,J.o)(),i=r.canvas,o=new V.fabric.FLine((0,R._)({stroke:"#000000",id:(0,U.Vj)()},n));return(0,q.pp)(o,e,r),i.add(o),i.setActiveObject(o),i.requestRenderAll(),o};function G(){var e=function(e){Y(e.options||{})},t=function(e){var t,n,r,i,o,a,l,s,c,h,u,d,f,v,p,g,m,b;switch(e.key){case"rect":case"rect-r":i=void 0===(r=(n=(t=e.options)||{}).width)?200:r,a=void 0===(o=n.height)?200:o,n.left,n.top,l=(0,D._)(n,["width","height","left","top"]),c=(s=(0,J.o)()).canvas,h=new V.fabric.Rect((0,R._)({id:(0,U.Vj)(),width:i,height:a},l)),(0,q.pp)(h,t,s),c.add(h),c.requestRenderAll(),c.setActiveObject(h);break;default:u=e.shape,(v=(d=e.options)||{}).left,v.top,p=v.points,g=(0,D._)(v,["left","top","points"]),b=(m=(0,J.o)()).canvas,f=u===V.fabric.Polygon?new V.fabric.Polygon(p,(0,R._)({id:(0,U.Vj)()},g)):new u((0,R._)({id:(0,U.Vj)()},g)),(0,q.pp)(f,d,m),b.add(f),b.requestRenderAll(),b.setActiveObject(f)}};return(0,i.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,i.tZ)(k,{children:"\u7EBF\u6761"}),(0,i.tZ)(u.Z,{gap:10,wrap:"wrap",justify:"space-around",children:T.map(function(t){return(0,i.tZ)("div",{onClick:function(){e(t)},className:"fabritor-panel-shape-item",children:(0,i.tZ)("img",{src:"data:image/svg+xml,".concat(encodeURIComponent(t.svg)),alt:"",style:{width:64,height:64}})},t.key)})}),(0,i.tZ)(k,{children:"\u5F62\u72B6"}),(0,i.tZ)(u.Z,{gap:10,wrap:"wrap",justify:"space-around",children:W.map(function(e){return(0,i.tZ)("div",{onClick:function(){t(e)},className:"fabritor-panel-shape-item",children:(0,i.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(e.elem)),style:{width:64,height:64}})},e.key)})})]})}var K=n(4414),Q=n(1443),$=n(9834),ee="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1699434105329" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6530" width="32" height="32" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M508.018 995.557c-269.887 0-488.675-218.785-488.675-488.675S238.13 18.206 508.018 18.206s488.676 218.787 488.676 488.676c0 269.89-218.788 488.675-488.676 488.675z m0-885.723c-219.283 0-397.048 177.763-397.048 397.048 0 219.284 177.765 397.05 397.048 397.05 219.285 0 397.049-177.766 397.049-397.05 0-219.285-177.764-397.048-397.049-397.048z m206.72 336.247h-87.822c-11.193 0-20.267-9.074-20.267-20.267s9.074-20.267 20.267-20.267h34.905c-31.736-44.89-83.812-74.31-142.994-74.31-97.007 0-175.645 78.638-175.645 175.643 0 11.194-9.074 20.267-20.267 20.267-11.192 0-20.266-9.073-20.266-20.267 0-119.391 96.786-216.177 216.178-216.177 72.505 0 136.49 35.795 175.644 90.603v-36.56c0-11.192 9.073-20.265 20.267-20.265s20.266 9.073 20.266 20.266v81.066c0 11.194-9.073 20.268-20.266 20.268z m-391.822 121.6h87.822c11.193 0 20.266 9.073 20.266 20.266 0 11.193-9.073 20.267-20.266 20.267h-35.18c31.76 44.942 84.035 74.31 143.269 74.31 97.005 0 175.644-78.638 175.644-175.644 0-11.193 9.073-20.266 20.267-20.266s20.266 9.073 20.266 20.266c0 119.392-96.786 216.179-216.177 216.179-72.597 0-136.54-35.95-175.645-90.892v36.847c0 11.193-9.074 20.267-20.267 20.267-11.192 0-20.267-9.074-20.267-20.267v-81.067c0-11.193 9.075-20.266 20.268-20.266z" fill="#515151" p-id="6531"></path></svg>')),et="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1699434105329" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6530" width="32" height="32" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M508.018 995.557c-269.887 0-488.675-218.785-488.675-488.675S238.13 18.206 508.018 18.206s488.676 218.787 488.676 488.676c0 269.89-218.788 488.675-488.676 488.675z m0-885.723c-219.283 0-397.048 177.763-397.048 397.048 0 219.284 177.765 397.05 397.048 397.05 219.285 0 397.049-177.766 397.049-397.05 0-219.285-177.764-397.048-397.049-397.048z m206.72 336.247h-87.822c-11.193 0-20.267-9.074-20.267-20.267s9.074-20.267 20.267-20.267h34.905c-31.736-44.89-83.812-74.31-142.994-74.31-97.007 0-175.645 78.638-175.645 175.643 0 11.194-9.074 20.267-20.267 20.267-11.192 0-20.266-9.073-20.266-20.267 0-119.391 96.786-216.177 216.178-216.177 72.505 0 136.49 35.795 175.644 90.603v-36.56c0-11.192 9.073-20.265 20.267-20.265s20.266 9.073 20.266 20.266v81.066c0 11.194-9.073 20.268-20.266 20.268z m-391.822 121.6h87.822c11.193 0 20.266 9.073 20.266 20.266 0 11.193-9.073 20.267-20.266 20.267h-35.18c31.76 44.942 84.035 74.31 143.269 74.31 97.005 0 175.644-78.638 175.644-175.644 0-11.193 9.073-20.266 20.267-20.266s20.266 9.073 20.266 20.266c0 119.392-96.786 216.179-216.177 216.179-72.597 0-136.54-35.95-175.645-90.892v36.847c0 11.193-9.074 20.267-20.267 20.267-11.192 0-20.267-9.074-20.267-20.267v-81.067c0-11.193 9.075-20.266 20.268-20.266z" fill="#F50909" p-id="6531"></path></svg>')),en=encodeURIComponent("\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='24' height='24'>\n  <defs>\n    <filter id='a' width='266.7%' height='156.2%' x='-75%' y='-21.9%' filterUnits='objectBoundingBox'>\n      <feOffset dy='1' in='SourceAlpha' result='shadowOffsetOuter1'/>\n      <feGaussianBlur in='shadowOffsetOuter1' result='shadowBlurOuter1' stdDeviation='1'/>\n      <feColorMatrix in='shadowBlurOuter1' result='shadowMatrixOuter1' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0'/>\n      <feMerge>\n        <feMergeNode in='shadowMatrixOuter1'/>\n        <feMergeNode in='SourceGraphic'/>\n      </feMerge>\n    </filter>\n    <path id='b' d='M1.67 12.67a7.7 7.7 0 0 0 0-9.34L0 5V0h5L3.24 1.76a9.9 9.9 0 0 1 0 12.48L5 16H0v-5l1.67 1.67z'/>\n  </defs>\n  <g fill='none' fill-rule='evenodd'><path d='M0 24V0h24v24z'/>\n    <g fill-rule='nonzero' filter='url(#a)' transform='rotate(90 5.25 14.75)'>\n      <use fill='#000' fill-rule='evenodd' xlink:href='#b'/>\n      <path stroke='#FFF' d='M1.6 11.9a7.21 7.21 0 0 0 0-7.8L-.5 6.2V-.5h6.7L3.9 1.8a10.4 10.4 0 0 1 0 12.4l2.3 2.3H-.5V9.8l2.1 2.1z'/>\n    </g>\n  </g>\n</svg>"),er="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138272519" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16833" width="32" height="32"><path d="M810.666667 85.333333a85.333333 85.333333 0 0 1 85.333333 85.333334v512a85.333333 85.333333 0 0 1-85.333333 85.333333h-85.333334v85.333333a85.333333 85.333333 0 0 1-85.333333 85.333334H213.333333a85.333333 85.333333 0 0 1-85.333333-85.333334V341.333333a85.333333 85.333333 0 0 1 85.333333-85.333333h85.333334V170.666667a85.333333 85.333333 0 0 1 85.333333-85.333334h426.666667z m-384 554.666667H341.333333a42.666667 42.666667 0 0 0-4.992 85.034667L341.333333 725.333333h85.333334a42.666667 42.666667 0 0 0 4.992-85.034666L426.666667 640z m384-469.333333H384v85.333333h256a85.333333 85.333333 0 0 1 85.333333 85.333333v341.333334h85.333334V170.666667z m-298.666667 298.666666H341.333333a42.666667 42.666667 0 1 0 0 85.333334h170.666667a42.666667 42.666667 0 1 0 0-85.333334z" p-id="16834" fill="#515151"></path></svg>')),ei="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138272519" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16833" width="32" height="32"><path d="M810.666667 85.333333a85.333333 85.333333 0 0 1 85.333333 85.333334v512a85.333333 85.333333 0 0 1-85.333333 85.333333h-85.333334v85.333333a85.333333 85.333333 0 0 1-85.333333 85.333334H213.333333a85.333333 85.333333 0 0 1-85.333333-85.333334V341.333333a85.333333 85.333333 0 0 1 85.333333-85.333333h85.333334V170.666667a85.333333 85.333333 0 0 1 85.333333-85.333334h426.666667z m-384 554.666667H341.333333a42.666667 42.666667 0 0 0-4.992 85.034667L341.333333 725.333333h85.333334a42.666667 42.666667 0 0 0 4.992-85.034666L426.666667 640z m384-469.333333H384v85.333333h256a85.333333 85.333333 0 0 1 85.333333 85.333333v341.333334h85.333334V170.666667z m-298.666667 298.666666H341.333333a42.666667 42.666667 0 1 0 0 85.333334h170.666667a42.666667 42.666667 0 1 0 0-85.333334z" p-id="16834" fill="#d81e06"></path></svg>')),eo="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138440243" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19137" width="32" height="32"><path d="M853.333333 192v42.666667a21.333333 21.333333 0 0 1-21.333333 21.333333h-640a21.333333 21.333333 0 0 1-21.333333-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333333-21.333333H384V128a42.666667 42.666667 0 0 1 42.666667-42.666667h170.666666a42.666667 42.666667 0 0 1 42.666667 42.666667v42.666667h192a21.333333 21.333333 0 0 1 21.333333 21.333333zM250.453333 859.306667a85.333333 85.333333 0 0 0 85.333334 79.36h353.28a85.333333 85.333333 0 0 0 85.333333-79.36L810.666667 341.333333H213.333333z" p-id="19138" fill="#515151"></path></svg>')),ea="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138440243" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19137" width="32" height="32"><path d="M853.333333 192v42.666667a21.333333 21.333333 0 0 1-21.333333 21.333333h-640a21.333333 21.333333 0 0 1-21.333333-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333333-21.333333H384V128a42.666667 42.666667 0 0 1 42.666667-42.666667h170.666666a42.666667 42.666667 0 0 1 42.666667 42.666667v42.666667h192a21.333333 21.333333 0 0 1 21.333333 21.333333zM250.453333 859.306667a85.333333 85.333333 0 0 0 85.333334 79.36h353.28a85.333333 85.333333 0 0 0 85.333333-79.36L810.666667 341.333333H213.333333z" p-id="19138" fill="#d81e06"></path></svg>')),el='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4941" width="22" height="22"><path d="M630.57970569 637.6867208l110.35938764 236.66748681c6.20083831 13.29490805 0.44014302 29.08827497-12.84181964 35.28911328l-96.26186588 44.88164187c-13.29490805 6.20083831-29.08827497 0.45308839-35.28911329-12.84181965l-112.87079191-242.05276602-138.77450271 138.77450272c-10.36925155 10.36925155-27.17235831 10.36925155-37.54160987 0.01294537a26.56392533 26.56392533 0 0 1-7.78017501-18.78375032V147.18616969c0-14.66711861 11.88386133-26.55097995 26.55097995-26.55097996 6.60214518 0 12.97127348 2.45962272 17.86462814 6.89988899l494.18998519 449.26950715c10.84823072 9.86438163 11.65084445 26.65454302 1.78646281 37.50277374a26.56004172 26.56004172 0 0 1-17.6057205 8.6086795L630.57970569 637.6867208z" p-id="4942" fill="#2c2c2c"></path></svg>',es="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 44L12 40L16 44L20 38L24 44L28 38L32 44L36 40L40 44V20C40 11.1634 32.8366 4 24 4C15.1634 4 8 11.1634 8 20V44Z" fill="none" stroke="#000000" stroke-width="4" stroke-linejoin="round"/><path d="M19 20H21" stroke="#000000" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M31 20H33" stroke="#000000" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>')),ec=n(2891);function eh(e){var t=e.value,n=e.onChange,r=e.trigger;return(0,i.tZ)(ec.Z,{value:t,onChange:function(e){n&&n(e.toHexString())},children:(0,i.tZ)("div",{className:"fabritor-toolbar-setter-trigger",children:r||(0,i.tZ)("div",{style:{width:24,height:24,backgroundColor:t,border:"1px solid #ccc",borderRadius:4}})})})}var eu=[{key:"p-1",svg:'<svg t="1701335273782" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="44143" width="32" height="32"><path d="M910.607 339.457c31.267-31.267 31.267-81.96 0-113.227l-113.21-113.193c-31.266-31.267-81.959-31.267-113.208 0l-28.315 28.298 226.436 226.42 28.297-28.298z m6.696 561.183H349.441L854.01 396.054l-226.434-226.42L89.81 707.4l0.231 0.231h-0.099v208.261c-0.051 0.537-0.082 1.082-0.082 1.634s0.031 1.096 0.082 1.635v14.491h11.778c1.587 0.494 3.275 0.76 5.026 0.76h810.557c9.317 0 16.887-7.552 16.887-16.886-0.001-9.335-7.57-16.886-16.887-16.886z" fill="#1296db" p-id="44144"></path></svg>',title:"\u94C5\u7B14",options:{color:"#1296db",width:4,strokeLineCap:"round"}},{key:"p-2",svg:'<svg t="1701335152027" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="39748" width="32" height="32"><path d="M1002.644 893.774H142.004c-11.782 0-21.312 9.562-21.312 21.344v42.656c0 11.782 9.532 21.344 21.312 21.344h860.64c11.782 0 21.342-9.562 21.342-21.344v-42.656c0-11.782-9.56-21.344-21.342-21.344z" fill="#FF0000" p-id="39749"></path><path d="M368.282 731.496l-90.5-90.496c-8.344-8.344-21.842-8.344-30.156 0L6.256 882.34a21.42 21.42 0 0 0-5.968 18.528 21.298 21.298 0 0 0 11.532 15.656l120.654 60.344a21.552 21.552 0 0 0 9.532 2.25c5.532 0 11-2.156 15.094-6.25l211.184-211.184c4-4 6.25-9.438 6.25-15.094s-2.252-11.094-6.252-15.094z" fill="#FF0000" p-id="39750"></path><path d="M459.874 702.434l-150.84-150.84c-8.312-8.344-21.844-8.344-30.156 0l-181.028 180.996c-4 4-6.25 9.438-6.25 15.094s2.25 11.094 6.25 15.094l150.84 150.84a21.356 21.356 0 0 0 30.186 0l180.998-181.028c4-4 6.25-9.438 6.25-15.094s-2.25-11.062-6.25-15.062z" fill="#FF0000" p-id="39751"></path><path d="M947.866 184.288l-120.688-120.684c-12.094-12.062-28.156-18.718-45.25-18.718s-33.154 6.656-45.248 18.718L173.286 627a21.332 21.332 0 0 0 0 30.188l180.996 180.996c4 4 9.438 6.25 15.094 6.25s11.094-2.25 15.094-6.25l563.396-563.398c12.092-12.062 18.748-28.156 18.748-45.248 0-17.094-6.656-33.158-18.748-45.25z" fill="#FF0000" p-id="39752"></path><path d="M947.866 274.786c12.092-12.062 18.748-28.156 18.748-45.248 0-17.094-6.656-33.156-18.748-45.25l-120.688-120.684 90.5 90.53c12.094 12.062 18.75 28.156 18.75 45.25s-6.656 33.156-18.75 45.25L354.282 808.028c-4 4-9.406 6.25-15.062 6.25a21.36 21.36 0 0 1-15.094-6.25l30.156 30.156c4 4 9.438 6.25 15.094 6.25s11.094-2.25 15.094-6.25l563.396-563.398z" fill="#FF0000" opacity=".2" p-id="39753"></path></svg>',title:"\u9A6C\u514B\u7B14",options:{color:"#FF0000",width:36,strokeLineCap:"square"}}];function ed(){var e=(0,a._)(K.Z.useForm(),1)[0],t=(0,a._)(K.Z.useForm(),1)[0],n=K.Z.Item,r=(0,a._)((0,s.useState)(0),2),o=r[0],l=r[1],c=(0,a._)((0,s.useState)(!0),2),h=c[0],d=c[1],f=(0,a._)((0,s.useState)(!1),2);f[0],f[1];var v=function(t){var n=(0,J.o)();t.color&&(n.canvas.freeDrawingBrush.color=t.color,e.setFieldValue("color",t.color)),t.width&&(n.canvas.freeDrawingBrush.width=t.width,e.setFieldValue("width",t.width)),t.strokeLineCap&&(n.canvas.freeDrawingBrush.strokeLineCap=t.strokeLineCap),t.shadow&&(n.canvas.freeDrawingBrush.shadow=new V.fabric.Shadow({blur:t.shadow.width,offsetX:t.shadow.offset,offsetY:t.shadow.offset,affectStroke:!0,color:t.shadow.color}))},p=function(){var n=(0,J.o)();if(null==n?void 0:n.canvas){n.canvas.isDrawingMode=!0,n.canvas.freeDrawingCursor='url("data:image/svg+xml;charset=utf-8,'.concat(encodeURIComponent('<svg t="1701336130548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="46063" width="16" height="16"><path d="M666.112 549.568l116.032-116.8-241.856-244.16-115.2 116.928-104.64 105.152-94.912 94.784A5667.84 5667.84 0 0 0 154.88 577.536c-19.456 19.456-30.784 31.744-36.48 36.992-10.304 10.048-19.584 21.12-27.52 32.96a198.272 198.272 0 0 0-17.088 33.088 208.64 208.64 0 0 0-17.088 42.88c-7.296 20.8-13.824 43.52-21.12 68.16-7.296 24.704-14.592 48.64-21.12 71.424a411.968 411.968 0 0 0-12.16 52.48 61.184 61.184 0 0 0 6.528 48.064 50.56 50.56 0 0 0 46.272 10.368c11.264-1.792 28.352-5.696 51.136-11.648a1664.32 1664.32 0 0 0 145.28-46.784c18.112-6.272 35.584-13.632 52.8-22.016 12.544-5.248 24.32-12.288 34.944-20.8 11.328-8.704 21.12-16.896 30.08-24.32a520.96 520.96 0 0 0 32.384-31.168l68.16-69.44c27.52-28.16 58.432-59.136 93.248-92.8l103.04-105.408z m232.064-232.384c5.632-6.08 12.928-12.992 21.12-20.8 8.128-7.808 17.856-16.896 27.52-27.328 8.96-9.472 16-20.48 21.12-32.448 4.16-10.752 6.336-22.208 6.528-33.728a202.24 202.24 0 0 0-3.2-32.448 119.872 119.872 0 0 0-8.96-27.328 272.512 272.512 0 0 0-50.304-74.56 255.04 255.04 0 0 0-60.096-49.92 205.952 205.952 0 0 0-30.784-11.648 141.568 141.568 0 0 0-35.712-5.888 112.768 112.768 0 0 0-38.08 5.248 115.52 115.52 0 0 0-38.08 20.096c-8.96 8.192-21.12 18.432-34.944 31.808-13.824 13.376-26.816 24.832-37.376 34.304l241.92 242.816c5.632-5.12 12.032-11.2 19.328-18.176z" fill="#2c2c2c" p-id="46064"></path></svg>'),'") 4 12, crosshair');var r=new V.fabric.PencilBrush(n.canvas);n.canvas.freeDrawingBrush=r;var i=eu[0].options,o=i.color,a=i.width;r.color=o,r.width=a,e.setFieldsValue({color:o,width:a}),t.setFieldsValue({color:"#000000",width:0,offset:0})}return function(){(null==n?void 0:n.canvas)&&(n.canvas.isDrawingMode=!1)}};return(0,s.useEffect)(function(){return p()},[]),(0,i.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,i.tZ)(k,{children:"\u753B\u7B14\u7C7B\u578B"}),(0,i.tZ)(u.Z,{wrap:"wrap",justify:"space-around",children:eu.map(function(e,t){return(0,i.tZ)(Q.Z,{trigger:"hover",title:e.title,children:(0,i.tZ)("div",{className:"fabritor-panel-shape-item",onClick:function(){v(e.options),l(t)},style:{padding:"4px 8px",backgroundColor:o===t?"#eeeeee":"rgba(0,0,0,0)",borderRadius:8},children:(0,i.tZ)("img",{src:"data:image/svg+xml,".concat(encodeURIComponent(e.svg)),alt:"",style:{width:56,height:56}})},e.key)})})}),(0,i.tZ)(k,{children:"\u753B\u7B14\u8BBE\u7F6E"}),(0,i.BX)(K.Z,{form:e,onValuesChange:function(e){v(e)},children:[(0,i.tZ)(n,{label:"\u989C\u8272",name:"color",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(n,{label:"\u7EBF\u5BBD",name:"width",children:(0,i.tZ)($.Z,{min:1,max:100})})]}),(0,i.tZ)(k,{children:"\u9634\u5F71\u8BBE\u7F6E"}),(0,i.BX)(K.Z,{form:t,onValuesChange:function(){v({shadow:t.getFieldsValue()})},children:[(0,i.tZ)(n,{label:"\u989C\u8272",name:"color",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(n,{label:"\u5BBD\u5EA6",name:"width",children:(0,i.tZ)($.Z,{min:0,max:50})}),(0,i.tZ)(n,{label:"\u504F\u79FB",name:"offset",children:(0,i.tZ)($.Z,{min:0,max:50})})]}),(0,i.tZ)(k,{children:"\u64CD\u4F5C"}),(0,i.tZ)(u.Z,{wrap:"wrap",justify:"space-around",children:(0,i.tZ)(y.ZP,{style:{width:64},onClick:function(){var e=(0,J.o)();e.canvas.isDrawingMode=!e.canvas.isDrawingMode,d(!h)},type:h?"default":"primary",title:"\u505C\u6B62\u7ED8\u56FE",children:(0,i.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(el)),style:{width:22,height:22}})})})]})}var ef=(0,s.createContext)(null);function ev(){return(ev=(0,o._)(function(e){return(0,l.Jh)(this,function(t){return[2,fetch("".concat(e,"?t=").concat(Date.now())).then(function(e){return e.json()})]})})).apply(this,arguments)}function ep(e){var t,n=e.onLoadTpl,r=(0,s.useRef)(null),c=(0,s.useContext)(ef),h=c.isReady,u=c.setReady,d=c.setActiveObject,f=(0,a._)((0,s.useState)([]),2),v=f[0],p=f[1],g=(t=(0,o._)(function(e){var t,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:if(!h)return[2];return t=(0,J.o)(),u(!1),t.canSaveLocal=!1,[4,function(e){return ev.apply(this,arguments)}(e.url)];case 1:return r=i.sent(),[4,t.loadFromJSON(r,!0)];case 2:return i.sent(),n(),d(t.sketch),u(!0),t.canSaveLocal=!0,[2]}})}),function(e){return t.apply(this,arguments)});return(0,s.useEffect)(function(){fetch("".concat("https://cdn.jsdelivr.net/gh/sleepy-zone/fabritor-assets/template/list_2.json","?t=").concat(Date.now())).then(function(e){return e.json()}).then(function(e){p(e)}).catch(function(){})},[]),(0,i.BX)("div",{className:"fabritor-panel-template-wrapper",style:{paddingTop:0},children:[(0,i.tZ)(y.ZP,{type:"primary",block:!0,onClick:function(){var e,t;null===(t=r.current)||void 0===t||null===(e=t.start)||void 0===e||e.call(t)},size:"large",children:"\u52A0\u8F7D\u672C\u5730\u6A21\u677F"}),(0,i.tZ)(k,{children:"\u9009\u62E9\u4E00\u4E2A\u6A21\u677F\u5F00\u59CB"}),(0,i.tZ)(B,{list:v,itemClick:g}),(0,i.tZ)(L,{ref:r,accept:"application/json",onChange:function(e){if(h){u(!1);var t,r=(0,J.o)();r.canSaveLocal=!1;var i=new FileReader;r.canvas.discardActiveObject(),i.onload=(t=(0,o._)(function(e){var t,i;return(0,l.Jh)(this,function(o){switch(o.label){case 0:if(!(i=null===(t=e.target)||void 0===t?void 0:t.result))return[3,2];return[4,r.loadFromJSON(i,!0)];case 1:o.sent(),u(!0),n(),d(r.sketch),o.label=2;case 2:return r.canSaveLocal=!0,[2]}})}),function(e){return t.apply(this,arguments)}),i.readAsText(e)}}})]})}var eg=n(8630),em=n(9372),eb=n(2684),ey=n(9752),eZ=(0,s.forwardRef)(function(e,t){var n,r=(0,a._)((0,s.useState)(!1),2),c=r[0],h=r[1],u=e.object,d=e.noCareOpen,f=(n=(0,o._)(function(e){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:switch(t=e.key,n=(0,J.o)(),t){case"copy":return[3,1];case"paste":return[3,3];case"copy&paste":return[3,4];case"del":return[3,7];case"group":return[3,8];case"ungroup":return[3,9];case"layer-up":case"layer-top":case"layer-down":case"layer-bottom":return[3,10]}return[3,11];case 1:case 4:return[4,(0,q.Zw)(n.canvas,u)];case 2:case 6:return r.sent(),[3,12];case 3:return(0,q.RI)(n.canvas),[3,12];case 5:return r.sent(),[4,(0,q.RI)(n.canvas)];case 7:return(0,q.GZ)(u,n.canvas),[3,12];case 8:return(0,q.h7)(n.canvas,u),[3,12];case 9:return(0,q.Z8)(n.canvas,u),[3,12];case 10:(0,q.dp)(t,n,u),r.label=11;case 11:return[3,12];case 12:return h(!1),[2]}})}),function(e){return n.apply(this,arguments)});return(0,s.useImperativeHandle)(t,function(){return{show:function(){return h(!0)},hide:function(){return h(!1)}}}),(0,i.tZ)(ey.Z,{menu:{items:function(){if(!u||u.id===em.vH)return[{label:"\u7C98\u8D34",key:"paste"}];var e=[{label:"\u590D\u5236",key:"copy"},{label:"\u7C98\u8D34",key:"paste"},{label:"\u521B\u5EFA\u526F\u672C",key:"copy&paste"},{label:"\u5220\u9664",key:"del"}];return"activeSelection"===u.type&&(e.push({type:"divider"}),e.push({label:"\u5EFA\u7EC4",key:"group"})),"group"!==u.type||u.sub_type||(e.push({type:"divider"}),e.push({label:"\u53D6\u6D88\u5EFA\u7EC4",key:"ungroup"})),"activeSelection"!==u.type&&(e.push({type:"divider"}),e.push({label:"\u56FE\u5C42",key:"layer",children:[{label:"\u4E0A\u79FB",key:"layer-up"},{label:"\u7F6E\u9876",key:"layer-top"},{label:"\u4E0B\u79FB",key:"layer-down"},{label:"\u7F6E\u5E95",key:"layer-bottom"}]})),e}(),onClick:f},trigger:["contextMenu"],open:d?void 0:c,children:e.children})});function ew(){var e=(0,s.useContext)(ef),t=e.isReady,n=e.object,r=(0,a._)((0,s.useState)([]),2),o=r[0],l=r[1],c=function(e){var t=(0,J.o)(),n=[],r=e.length;if(!r){l([]);return}for(var i=t.canvas.getActiveObject(),o=r-1;o>=0;o--){var a=e[o];a&&a.id!==em.vH&&(i===a?a.__cover=a.toDataURL():a.__cover||(a.__cover=a.toDataURL()),n.push({cover:a.__cover,group:"group"===a.type,object:a}))}l(n)},h=function(e){var t=(0,J.o)();t.canvas.discardActiveObject(),t.canvas.setActiveObject(e.object),t.canvas.requestRenderAll()};return(0,s.useEffect)(function(){var e,n=function(){c(e.getObjects())};return t&&(l([]),e=(0,J.o)().canvas,n(),e.on({"object:added":n,"object:removed":n,"object:modified":n,"object:skewing":n,"fabritor:object:modified":n})),function(){e&&e.off({"object:added":n,"object:removed":n,"object:modified":n,"object:skewing":n,"fabritor:object:modified":n})}},[t]),(0,i.tZ)("div",{className:"fabritor-panel-template-wrapper",style:{paddingTop:0},children:(0,i.tZ)(eg.Z,{dataSource:o,renderItem:function(e){return(0,i.tZ)(eZ,{object:e.object,noCareOpen:!0,children:(0,i.tZ)(eg.Z.Item,{className:"fabritor-panel-layer-item",style:{border:n===e.object?" 2px solid #ff2222":"2px solid transparent",padding:"10px 16px"},onClick:function(){h(e)},children:(0,i.BX)(u.Z,{justify:"space-between",align:"center",style:{width:"100%",height:40},children:[(0,i.tZ)("img",{src:e.cover,style:{maxWidth:200,maxHeight:34}}),e.group?(0,i.tZ)(eb.Z,{style:{fontSize:18,color:"rgba(17, 23, 29, 0.6)"}}):null]})})})}})})}function ek(e){var t=(0,a._)((0,s.useState)(e.defaultKey),2),n=t[0],r=t[1],o=[{key:"layers",label:"\u56FE\u5C42",children:(0,i.tZ)(ew,{})},{key:"template",label:"\u6A21\u677F\u5E93",children:(0,i.tZ)(ep,{onLoadTpl:function(){r("layers")}})}];return(0,i.tZ)("div",{className:"fabritor-panel-wrapper",style:{padding:0},children:(0,i.tZ)(d.Z,{activeKey:n,onChange:r,items:o,centered:!0})})}var ex=c.Z.Header,eC={padding:"0 16px",height:50,backgroundColor:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #e8e8e8"};function e_(){return(0,i.tZ)(ex,{style:eC,children:(0,i.BX)(u.Z,{align:"center",gap:5,children:[(0,i.tZ)("img",{src:es}),(0,i.tZ)("span",{style:{fontWeight:"bold",fontSize:15},children:"fabritor, A creative editor based on fabricjs."})]})})}var eS=n(1527),ej=n(2624),eB=n(9062);function eR(e){var t,n=e.effectKey,r=void 0===n?"fill":n,o=e.defaultColor,l=void 0===o?"#ffffff":o,c=e.trigger,h=e.type,u=(0,a._)((0,s.useState)(),2),d=u[0],f=u[1],v=(0,s.useContext)(ef).object,p=function(){switch(null==d?void 0:d.type){case"solid":return d.color;case"linear":case"radial":return"url(#colorsetter-icon-gradient) ".concat(d.color||"rgba(0, 0, 0, 0.88)");default:return"rgba(0, 0, 0, 0.88)"}};return(0,s.useEffect)(function(){if(v){var e=v[r];"f-text"===v.type&&"fill"===r&&e instanceof V.fabric.Pattern?f({type:"solid",color:"#000000"}):f((0,U.YX)(e))}},[v]),(0,i.BX)(eS.Fragment,{children:[(0,i.tZ)(P.Z,{content:(0,i.tZ)(eB.Z,{value:d,onChange:function(e){if(e){e.color||(e.color=l),f(e);var t,n=(0,U.jq)(e);if("f-text"===v.type&&"string"!=typeof n){n.gradientUnits="pixels";var i=n.coords;n.coords={x1:1===i.x1?v.width:0,y1:1===i.y1?v.height:0,x2:1===i.x2?v.width:0,y2:1===i.y2?v.height:0,r1:0,r2:v.width>v.height?v.width/2:v.height}}"string"!=typeof n&&(n=new V.fabric.Gradient(n)),v.set(r,n),null==v||null===(t=v.canvas)||void 0===t||t.requestRenderAll()}},format:"hex",angleType:"rotate"}),trigger:"click",children:(0,i.tZ)("div",{className:"fabritor-toolbar-setter-trigger",children:(0,i.tZ)("div",{style:{borderRadius:4,border:function(){if((null==d?void 0:d.type)==="solid"&&"#ffffff"===new ej.Il(d.color).toHexString())return"1px solid rgb(204,204,204)"}(),lineHeight:0},children:c||("fontColor"===h?(0,i.tZ)("svg",{viewBox:"64 64 896 896",focusable:"false",width:22,height:22,fill:p(),"aria-hidden":"true",children:(0,i.tZ)("path",{d:"M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zm-650.3-80h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-.2 3.2-.5a9.7 9.7 0 006-12.4L573.6 118.6a9.9 9.9 0 00-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-.4 1-.5 2.1-.5 3.2-.1 5.3 4.3 9.7 9.7 9.7zm255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z"})}):"sketch"===h?(0,i.tZ)("svg",{width:22,height:22,viewBox:"64 64 896 896",focusable:"false",fill:p(),"aria-hidden":"true",children:(0,i.tZ)("path",{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"})}):(0,i.tZ)("div",{style:{width:24,height:24,background:function(){var e,t,n;switch(null==d?void 0:d.type){case"solid":return d.color;case"linear":return"linear-gradient(".concat(null===(e=d.gradient)||void 0===e?void 0:e.angle,"deg, ").concat(null===(t=d.gradient)||void 0===t?void 0:t.colorStops.map(function(e){return"".concat(e.color," ").concat(100*e.offset,"%")}),")");case"radial":return"radial-gradient(at 50% 50%, ".concat(null===(n=d.gradient)||void 0===n?void 0:n.colorStops.map(function(e){return"".concat(e.color," ").concat(100*e.offset,"%")}),")");default:return"rgba(0, 0, 0, 0.88)"}}(),borderRadius:4}}))})})}),(0,i.tZ)("svg",{style:{width:0,height:0,position:"absolute"},"aria-hidden":"true",focusable:"false",children:(0,i.tZ)("linearGradient",{id:"colorsetter-icon-gradient",x2:"1",y2:"1",children:null==d?void 0:null===(t=d.gradient)||void 0===t?void 0:t.colorStops.map(function(e){return(0,i.tZ)("stop",{offset:"".concat(100*e.offset,"%"),"stop-color":e.color})})})})]})}var ez=n(4358),eH=K.Z.Item;function eL(e){var t=(0,a._)(K.Z.useForm(),1)[0],n=e.value,r=e.onChange;return(0,s.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,i.BX)(K.Z,{form:t,onValuesChange:function(e){r&&r((0,R._)({},n,e))},children:[(0,i.tZ)(eH,{label:"\u542F\u7528",name:"enable",valuePropName:"checked",children:(0,i.tZ)(ez.Z,{})}),(0,i.tZ)(eH,{label:"\u989C\u8272",name:"color",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(eH,{label:"\u6A21\u7CCA",name:"blur",children:(0,i.tZ)($.Z,{min:0,max:100})}),(0,i.tZ)(eH,{label:"\u504F\u79FB",name:"offset",children:(0,i.tZ)($.Z,{min:-180,max:180})})]})}var eO=K.Z.Item;function eP(e){var t=(0,a._)(K.Z.useForm(),1)[0],n=e.value,r=e.onChange;return(0,s.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,i.BX)(K.Z,{form:t,onValuesChange:function(e){r&&r((0,R._)({},n,e))},children:[(0,i.tZ)(eO,{label:"\u542F\u7528",name:"enable",valuePropName:"checked",children:(0,i.tZ)(ez.Z,{})}),(0,i.tZ)(eO,{label:"\u504F\u79FB",name:"offset",children:(0,i.tZ)($.Z,{min:-100,max:100})})]})}var eM=K.Z.Item;function eF(e){var t=(0,a._)(K.Z.useForm(),1)[0],n=e.value,r=e.onChange;return(0,s.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,i.BX)(K.Z,{form:t,onValuesChange:function(e){r&&r((0,R._)({},n,e))},children:[(0,i.tZ)(eM,{label:"\u542F\u7528",name:"enable",valuePropName:"checked",children:(0,i.tZ)(ez.Z,{})}),(0,i.tZ)(eM,{label:"\u56FE\u7247",name:"url",children:(0,i.tZ)(X,{})})]})}var eA=K.Z.Item;function eX(){var e,t,n=(0,a._)(K.Z.useForm(),1)[0],r=(0,s.useContext)(ef),c=r.object,h=r.setFxType,u=(e=(0,o._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!e.enable||!e.url)return c.fill instanceof V.fabric.Pattern&&c.set("fill","#000000"),[2,Promise.resolve()];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,j.vB)(e.url)];case 2:return t=n.sent(),c.set("fill",new V.fabric.Pattern({source:t,repeat:"repeat"})),[3,4];case 3:return console.log(n.sent()),[3,4];case 4:return[2]}})}),function(t){return e.apply(this,arguments)}),d=(t=(0,o._)(function(e){var t,n,r,i,o,a,s,h,d,f;return(0,l.Jh)(this,function(l){switch(l.label){case 0:t=(0,J.o)(),n=Object.keys(e),r=!0,i=!1,o=void 0,l.label=1;case 1:l.trys.push([1,9,10,11]),a=n[Symbol.iterator](),l.label=2;case 2:if(r=(s=a.next()).done)return[3,8];if(d=e[h=s.value],"shadow"!==h)return[3,3];return d.enable?c.shadow={color:d.color,blur:d.blur,offsetX:d.offset,offsetY:d.offset}:c.shadow=null,[3,7];case 3:if("path"!==h)return[3,4];return d.enable?(0,_.bG)(c,d.offset):(0,_.we)(c),[3,7];case 4:if("pattern"!==h)return[3,6];return[4,u(d)];case 5:return l.sent(),[3,7];case 6:c.set(h,d),l.label=7;case 7:return r=!0,[3,2];case 8:return[3,11];case 9:return f=l.sent(),i=!0,o=f,[3,11];case 10:try{r||null==a.return||a.return()}finally{if(i)throw o}return[7];case 11:return t.canvas.requestRenderAll(),t.fireCustomModifiedEvent(),[2]}})}),function(e){return t.apply(this,arguments)}),f=function(){var e,t,r,i,o=c.fill;n.setFieldsValue({stroke:c.stroke,strokeWidth:c.strokeWidth||0,textBackgroundColor:c.textBackgroundColor,shadow:{enable:!!c.shadow,color:(null===(e=c.shadow)||void 0===e?void 0:e.color)||c.stroke,blur:(null===(t=c.shadow)||void 0===t?void 0:t.blur)||0,offset:(null===(r=c.shadow)||void 0===r?void 0:r.offsetX)||0},path:{enable:!!c.path,offset:(0,_.h1)(c)},pattern:{enable:o instanceof V.fabric.Pattern,url:null==o?void 0:null===(i=o.source)||void 0===i?void 0:i.src}})};return(0,s.useEffect)(function(){c&&("textbox"===c.type||"f-text"===c.type)?f():h("")},[c]),(0,i.tZ)("div",{className:"fabritor-setter-panel",children:(0,i.BX)(K.Z,{form:n,onValuesChange:d,style:{padding:"0 16px"},children:[(0,i.tZ)(k,{children:"\u63CF\u8FB9"}),(0,i.tZ)(eA,{label:"\u989C\u8272",children:(0,i.tZ)(eR,{effectKey:"stroke"})}),(0,i.tZ)(eA,{label:"\u7C97\u7EC6",name:"strokeWidth",children:(0,i.tZ)($.Z,{min:0,max:100})}),(0,i.tZ)(k,{children:"\u9634\u5F71"}),(0,i.tZ)(eA,{name:"shadow",children:(0,i.tZ)(eL,{})}),(0,i.tZ)(k,{children:"\u6CE2\u6D6A\u578B\u6587\u5B57"}),(0,i.tZ)(eA,{name:"path",children:(0,i.tZ)(eP,{})}),(0,i.tZ)(k,{children:"\u56FE\u7247\u586B\u5145"}),(0,i.tZ)(eA,{name:"pattern",children:(0,i.tZ)(eF,{})})]})})}var eE=[{label:"\u65E0",value:"none",src:"https://cdn.pixabay.com/photo/2017/02/15/13/18/girl-2068638_1280.jpg"},{label:"\u590D\u53E4",value:"Sepia",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u590D\u53E4.png"},{label:"\u80F6\u7247",value:"Kodachrome",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u80F6\u7247.png"},{label:"\u8001\u7167\u7247",value:"Vintage",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u8001\u7167\u7247.png"},{label:"\u5B9D\u4E3D\u6765",value:"Polaroid",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u5B9D\u4E3D\u6765.png"},{label:"\u6A21\u7CCA",value:"Blur",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u6A21\u7CCA.png"},{label:"\u6D6E\u96D5",value:"Emboss",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u6D6E\u96D5.png"},{label:"\u50CF\u7D20",value:"Pixelate",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u50CF\u7D20.png"},{label:"\u9ED1\u767D",value:"Grayscale",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u9ED1\u767D.png"},{label:"\u8C03\u8272",value:"HueRotation",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u8C03\u8272.png"}];function eT(e){var t=e.value,n=e.onChange,r=function(e,r){null==n||n((0,z._)((0,R._)({},t),{[r]:e}))};return(0,i.tZ)("div",{className:"fabritor-radio-image-group",children:eE.map(function(e){return(0,i.BX)("div",{className:"fabritor-radio-image-group-item",onClick:function(){r(e.value,"type")},children:[(0,i.tZ)("div",{className:"fabritor-radio-image-group-img",style:{borderColor:(null==t?void 0:t.type)===e.value?"#ff2222":"#eeeeee"},children:(0,i.tZ)("img",{src:e.src,style:{width:"100%"}})}),(0,i.tZ)("span",{children:e.label}),"Blur"===e.value&&(null==t?void 0:t.type)==="Blur"?(0,i.tZ)($.Z,{min:0,max:1,step:.01,value:(null==t?void 0:t.param)==void 0?.2:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null,"Pixelate"===e.value&&(null==t?void 0:t.type)==="Pixelate"?(0,i.tZ)($.Z,{min:2,max:20,step:.01,value:(null==t?void 0:t.param)==void 0?4:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null,"HueRotation"===e.value&&(null==t?void 0:t.type)==="HueRotation"?(0,i.tZ)($.Z,{min:-2,max:2,step:.002,value:(null==t?void 0:t.param)==void 0?0:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null]})})})}var eV=K.Z.Item,eI=function(e){if(!e)return{type:"none"};var t=e.type;return"Blur"===t?{type:t,param:e.blur}:"Pixelate"===t?{type:t,param:e.blocksize}:"HueRotation"===t?{type:t,param:e.rotation}:{type:t}};function eN(){var e=(0,s.useContext)(ef),t=e.object,n=e.setFxType,r=(0,a._)(K.Z.useForm(),1)[0],o=function(){var e=t.getFilter();console.log(e),r.setFieldsValue({filter:eI(e)})};return(0,s.useEffect)(function(){t&&"f-image"===t.type?o():n("")},[t]),(0,i.tZ)("div",{className:"fabritor-setter-panel",children:(0,i.tZ)(K.Z,{form:r,onValuesChange:function(e){if(e.filter){var n,r=e.filter,i=r.type,o=r.param;n="Emboss"===i?new V.fabric.Image.filters.Convolute({matrix:[1,1,1,1,.7,-1,-1,-1,-1]}):"none"===i?null:new V.fabric.Image.filters[i],"Blur"===i&&(n.blur=void 0==o?.2:o),"Pixelate"===i&&(n.blocksize=void 0==o?4:o),"HueRotation"===i&&(n.rotation=void 0==o?0:o),t.applyFilter(n),t.canvas.requestRenderAll()}},style:{padding:"0 16px"},children:(0,i.tZ)(eV,{name:"filter",children:(0,i.tZ)(eT,{})})})})}var eW=n(4369),eD=n(5420),eJ=n(4480),eU=n(4420),eq=n(6411),eY=n(6898),eG=n(3693);function eK(e){var t=e.title,n=e.children,r=e.back;return(0,i.tZ)(Z.Z,{bordered:!1,style:{marginLeft:-24,boxShadow:"none"},bodyStyle:{padding:12},title:(0,i.BX)(u.Z,{justify:"space-between",children:[(0,i.tZ)(eG.Z,{onClick:function(){r&&r()}}),(0,i.tZ)("p",{children:t})]}),children:n})}var eQ=K.Z.Item;function e$(e){var t=e.back,n=(0,a._)(K.Z.useForm(),1)[0],r=(0,a._)(K.Z.useForm(),1)[0],o=(0,a._)((0,s.useState)({value:"fabritor"}),2),l=o[0],c=o[1],h=(0,s.useRef)(null),d=function(e){c((0,R._)({},l,e))};return(0,s.useEffect)(function(){n.setFieldsValue({value:"fabritor",size:160}),r.setFieldsValue({color:"#000000",bgColor:"#00000000",iconSize:40,errorLevel:"M"})},[]),(0,i.BX)(eK,{title:"\u4E8C\u7EF4\u7801",back:t,children:[(0,i.BX)(K.Z,{form:n,onValuesChange:d,children:[(0,i.tZ)(eQ,{name:"value",label:"\u6587\u672C",children:(0,i.tZ)(F.Z,{})}),(0,i.tZ)(eQ,{name:"size",label:"\u5927\u5C0F",children:(0,i.tZ)(eJ.Z,{})})]}),(0,i.tZ)(eU.Z,{items:[{key:"1",label:"\u5176\u4ED6\u8BBE\u7F6E",children:(0,i.BX)(K.Z,{form:r,onValuesChange:d,children:[(0,i.tZ)(eQ,{name:"color",label:"\u989C\u8272",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(eQ,{name:"bgColor",label:"\u80CC\u666F\u8272",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(eQ,{name:"errorLevel",label:"\u7EA0\u9519\u7B49\u7EA7",children:(0,i.tZ)(eq.ZP.Group,{options:["L","M","Q","H"]})}),(0,i.tZ)(eQ,{name:"icon",label:"\u5185\u7F6E\u56FE\u7247",children:(0,i.tZ)(F.Z,{placeholder:"\u4EC5\u652F\u6301\u56FE\u7247\u94FE\u63A5"})}),(0,i.tZ)(eQ,{name:"iconSize",label:"\u5185\u7F6E\u56FE\u7247\u5927\u5C0F",children:(0,i.tZ)(eJ.Z,{})})]})}]}),l.value?(0,i.BX)(u.Z,{vertical:!0,align:"center",gap:10,style:{marginTop:16},ref:h,children:[(0,i.tZ)(eY.Z,(0,z._)((0,R._)({type:"canvas"},l),{style:{maxWidth:200}})),(0,i.tZ)(y.ZP,{type:"primary",onClick:function(){if(l.value&&h.current){var e=h.current.querySelector("canvas");if(e){var t=new Image;t.onload=function(){(0,j.Bi)({imageSource:t})},t.src=e.toDataURL()}}},children:"\u6DFB\u52A0\u81F3\u753B\u5E03"})]}):null]})}var e0=n(3715),e1=n(696);function e3(e){var t,n=e.back,r=(t=(0,o._)(function(e){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(!((n=(t=(0,J.o)()).canvas.getActiveObject())&&"textbox"===n.type))return[3,1];return n.set("text","".concat(n.text).concat(e.native)),t.canvas.requestRenderAll(),[3,3];case 1:return[4,(0,_.JE)({text:e.native,fontSize:80,width:100})];case 2:r.sent(),r.label=3;case 3:return[2]}})}),function(e){return t.apply(this,arguments)});return(0,i.tZ)(eK,{title:"Emoji",back:n,children:(0,i.tZ)(e1.Z,{data:e0,perLine:8,set:"native",locale:"zh",onEmojiSelect:r})})}var e2=[{title:"\u4E8C\u7EF4\u7801",key:"qrcode",icon:(0,i.tZ)(eW.Z,{style:{fontSize:30}})},{title:"Emoji",key:"emoji",icon:(0,i.tZ)(eD.Z,{style:{fontSize:30}})}];function e6(){var e=(0,a._)((0,s.useState)(""),2),t=e[0],n=e[1],r=function(e){n(e.key)},o=function(){n("")};return(0,i.tZ)("div",{children:t?"qrcode"===t?(0,i.tZ)(e$,{back:o}):"emoji"===t?(0,i.tZ)(e3,{back:o}):null:(0,i.tZ)(u.Z,{wrap:"wrap",gap:12,justify:"space-around",style:{padding:"16px 16px 16px 0",marginLeft:-8},children:e2.map(function(e){return(0,i.tZ)(Z.Z,{hoverable:!0,style:{width:150,paddingTop:12},cover:e.icon,bodyStyle:{padding:12},onClick:function(){r(e)},children:(0,i.tZ)(Z.Z.Meta,{description:e.title,style:{textAlign:"center"}})},e.key)})})})}var e4=c.Z.Sider,e5={position:"relative",backgroundColor:"#fff",borderRight:"1px solid #e8e8e8"},e8={fontSize:18,marginRight:0},e7=[{label:"\u8BBE\u8BA1",value:"design",icon:(0,i.tZ)(f.Z,{style:e8})},{label:"\u6587\u5B57",value:"text",icon:(0,i.tZ)(v.Z,{style:e8})},{label:"\u56FE\u7247",value:"image",icon:(0,i.tZ)(p.Z,{style:e8})},{label:"\u7D20\u6750",value:"shape",icon:(0,i.tZ)(g.Z,{style:e8})},{label:"\u753B\u7B14",value:"paint",icon:(0,i.tZ)(m.Z,{style:e8})},{label:"\u5E94\u7528",value:"app",icon:(0,i.tZ)(b.Z,{style:e8})}];function e9(){var e=(0,s.useContext)(ef),t=e.fxType,n=e.setFxType,r=(0,a._)((0,s.useState)("design"),2),o=r[0],l=r[1],c=(0,a._)((0,s.useState)("template"),2),h=c[0],f=c[1];return(0,s.useEffect)(function(){t?l(""):(l(o||"design"),f("layers"))},[t]),(0,i.BX)(e4,{style:e5,width:420,className:"fabritor-sider",children:[(0,i.tZ)(e_,{}),(0,i.tZ)(d.Z,{activeKey:o,tabPosition:"left",style:{flex:1,overflow:"auto"},size:"small",onChange:function(e){f("layers"),l(e),n("");var t=(0,J.o)();(null==t?void 0:t.canvas)&&("paint"===e?t.canvas.isDrawingMode=!0:t.canvas.isDrawingMode=!1)},items:e7.map(function(e){var t;return{label:(0,i.BX)(u.Z,{vertical:!0,justify:"center",children:[(0,i.tZ)("div",{children:e.icon}),(0,i.tZ)("div",{children:e.label})]}),key:e.value,children:"design"===(t=e.value)?(0,i.tZ)(ek,{defaultKey:h}):"text"===t?(0,i.tZ)(S,{}):"image"===t?(0,i.tZ)(E,{}):"shape"===t?(0,i.tZ)(G,{}):"paint"===t?(0,i.tZ)(ed,{}):"app"===t?(0,i.tZ)(e6,{}):null}})}),"text"===t?(0,i.tZ)(eX,{}):null,"image"===t?(0,i.tZ)(eN,{}):null]})}var te=n(531),tt=n(4212),tn=n(6197),tr=n(8564),ti=n(9437),to=[{icon:tt.Z,value:"bold"},{icon:tn.Z,value:"italic"},{icon:tr.Z,value:"underline"},{icon:ti.Z,value:"linethrough"}];function ta(e){var t=e.value,n=e.onChange,r=function(e){n&&n((0,z._)((0,R._)({},t),{[e]:!t[e]}))};return(0,i.tZ)(P.Z,{content:(0,i.tZ)(M.Z.Compact,{block:!0,children:to.map(function(e){return(0,i.tZ)(y.ZP,{style:{width:46},icon:(0,i.tZ)(e.icon,{style:{color:(null==t?void 0:t[e.value])?"#1677ff":""}}),onClick:function(){r(e.value)}},e.value)})}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:(0,i.BX)("svg",{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.tZ)("path",{d:"M32 6H42V16",stroke:"#000000","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,i.tZ)("path",{d:"M17 32L19.1875 27M31 32L28.8125 27M19.1875 27L24 16L28.8125 27M19.1875 27H28.8125",stroke:"#000000","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,i.tZ)("path",{d:"M16 6H6V16",stroke:"#000000","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,i.tZ)("path",{d:"M32 42H42V32",stroke:"#000000","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,i.tZ)("path",{d:"M16 42H6V32",stroke:"#000000","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"})]})})})}var tl=n(6785),ts=n(7708),tc=n(2458),th=[{label:(0,i.tZ)(tl.Z,{}),value:"left"},{label:(0,i.tZ)(ts.Z,{}),value:"center"},{label:(0,i.tZ)(tc.Z,{}),value:"right"}],tu={left:tl.Z,center:ts.Z,right:tc.Z};function td(e){var t=e.value,n=(0,D._)(e,["value"]);return(0,i.tZ)(P.Z,{content:(0,i.tZ)(eq.ZP.Group,(0,z._)((0,R._)({value:t},n),{options:th,optionType:"button",buttonStyle:"solid"})),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:function(){if(!t)return null;var e=tu[t];return(0,i.tZ)(e,{style:{fontSize:22}})}()})})}var tf=n(976);function tv(e){var t=e.value,n=e.onChange,r=function(e,r){n&&n((0,z._)((0,R._)({},t),{[r]:e}))};return(0,i.tZ)(P.Z,{content:(0,i.BX)(u.Z,{vertical:!0,gap:8,style:{width:200},children:[(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u884C\u95F4\u8DDD"}),(0,i.tZ)($.Z,{min:.5,max:2.5,step:.01,value:null==t?void 0:t.lineHeight,onChange:function(e){r(e,"lineHeight")}})]}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u5B57\u95F4\u8DDD"}),(0,i.tZ)($.Z,{min:-200,max:800,step:1,value:null==t?void 0:t.charSpacing,onChange:function(e){r(e,"charSpacing")}})]})]}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:(0,i.tZ)(tf.Z,{style:{fontSize:22}})})})}var tp=n(8492);function tg(e){var t=e.value,n=e.onChange;return(0,i.tZ)(P.Z,{content:(0,i.tZ)($.Z,{style:{width:200},min:1,max:400,step:1,onChange:n,value:t}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:(0,i.BX)("svg",{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.tZ)("path",{d:"M4 8H32",stroke:"#000000","stroke-width":"4","stroke-linecap":"square"}),(0,i.tZ)("path",{d:"M28 21H44",stroke:"#000000","stroke-width":"4","stroke-linecap":"square"}),(0,i.tZ)("path",{d:"M18 42L18 8",stroke:"#000000","stroke-width":"4","stroke-linecap":"square"}),(0,i.tZ)("path",{d:"M36 42L36 21",stroke:"#000000","stroke-width":"4","stroke-linecap":"square"})]})})})}var tm=K.Z.Item;function tb(){var e,t=(0,s.useContext)(ef),n=t.object,r=t.setFxType,c=(0,a._)(K.Z.useForm(),1)[0],h=function(e){n.set("fontWeight",(null==e?void 0:e.bold)?"bold":"normal"),n.set("fontStyle",(null==e?void 0:e.italic)?"italic":"normal"),n.set("underline",!!e.underline),n.set("linethrough",!!e.linethrough)},u=function(e){n.set("lineHeight",e.lineHeight),n.set("charSpacing",e.charSpacing)},d=function(e){n.set("stroke",e.stroke),n.set("strokeWidth",e.strokeWidth)},f=(e=(0,o._)(function(e){var t,r,i,o,a,s,c,f,v,p;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(!(null===(t=r=Object.keys(e))||void 0===t?void 0:t.length))return[2];i=!0,o=!1,a=void 0,l.label=1;case 1:l.trys.push([1,11,12,13]),s=r[Symbol.iterator](),l.label=2;case 2:if(i=(c=s.next()).done)return[3,10];if("fontStyles"!==(f=c.value))return[3,3];return h(e[f]),[3,9];case 3:if("fontFamily"!==f)return[3,8];l.label=4;case 4:return l.trys.push([4,,6,7]),[4,(0,U.mx)(e[f])];case 5:return l.sent(),[3,7];case 6:return n.set(f,e[f]),[7];case 7:return[3,9];case 8:"space"===f?u(e[f]):"border"===f?d(e[f]):n.getSelectedText()&&"fill"===f?n.setSelectionStyles({fill:e[f]}):(n.set("styles",{}),n.set(f,e[f])),l.label=9;case 9:return i=!0,[3,2];case 10:return[3,13];case 11:return v=l.sent(),o=!0,a=v,[3,13];case 12:try{i||null==s.return||s.return()}finally{if(o)throw a}return[7];case 13:return(p=(0,J.o)()).canvas.requestRenderAll(),p.fireCustomModifiedEvent(),[2]}})}),function(t){return e.apply(this,arguments)});return(0,s.useEffect)(function(){c.setFieldsValue({fontFamily:n.fontFamily,fontSize:n.fontSize,fill:n.fill,textAlign:n.textAlign,space:{lineHeight:n.lineHeight,charSpacing:n.charSpacing},fontStyles:{bold:"bold"===n.fontWeight,italic:"italic"===n.fontStyle,underline:n.underline,linethrough:n.linethrough},border:{stroke:n.stroke,strokeWidth:n.strokeWidth}})},[n]),(0,i.BX)(K.Z,{form:c,onValuesChange:f,layout:"inline",className:"fabritor-toolbar-form-text",children:[(0,i.tZ)(tm,{name:"fontFamily",children:(0,i.tZ)(te.Z,{options:em.TX,style:{width:160}})}),(0,i.tZ)(tm,{name:"fontSize",children:(0,i.tZ)(tg,{})}),(0,i.tZ)(tm,{children:(0,i.tZ)(eR,{type:"fontColor",defaultColor:"#000000"})}),(0,i.tZ)(tm,{name:"space",children:(0,i.tZ)(tv,{})}),(0,i.tZ)(tm,{name:"textAlign",children:(0,i.tZ)(td,{})}),(0,i.tZ)(tm,{name:"fontStyles",children:(0,i.tZ)(ta,{})}),(0,i.tZ)(tm,{children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){r("text")},children:(0,i.tZ)(tp.Z,{style:{fontSize:22}})})})]})}function ty(){return(0,i.tZ)(w.Z,{type:"vertical",style:{height:32}})}function tZ(e){var t=e.onChange;return(0,i.tZ)(P.Z,{content:(0,i.tZ)(X,{onChange:t}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:"\u66FF\u6362\u56FE\u7247"})})}var tw=[{key:"flipX",label:"\u6C34\u5E73\u7FFB\u8F6C"},{key:"flipY",label:"\u5782\u76F4\u7FFB\u8F6C"}];function tk(e){var t=e.onChange;return(0,i.tZ)(ey.Z,{placement:"bottom",trigger:["click"],menu:{items:tw,onClick:function(e){var n=e.key;t&&t(n)}},arrow:!0,children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:"\u7FFB\u8F6C"})})}var tx=[{key:"none",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.071 19.071c-3.905 3.905-10.237 3.905-14.142 0-3.905-3.905-3.905-10.237 0-14.142 3.905-3.905 10.237-3.905 14.142 0 3.905 3.905 3.905 10.237 0 14.142ZM5.482 17.457 17.457 5.482A8.5 8.5 0 0 0 5.482 17.457Zm1.06 1.06A8.501 8.501 0 0 0 18.519 6.544L6.543 18.518Z" fill="currentColor"></path></svg>'},{key:"line",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x2="24" y1="50%" y2="50%" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"12,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="-1" x2="25" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="12 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"6,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="6 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"2,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="2 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'}];function tC(e){var t=e.value,n=e.onChange,r=function(e,r){n&&n((0,z._)((0,R._)({},t),{[r]:e}))};return(0,i.tZ)(P.Z,{content:(0,i.BX)(u.Z,{vertical:!0,gap:8,children:[(0,i.tZ)(eq.ZP.Group,{value:null==t?void 0:t.type,onChange:function(e){r(e.target.value,"type")},children:tx.map(function(e){return(0,i.tZ)(eq.ZP.Button,{value:e.key,children:(0,i.tZ)("span",{dangerouslySetInnerHTML:{__html:e.svg},style:{display:"inline-flex",alignItems:"center",marginTop:3}})},e.key)})}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u989C\u8272"}),(0,i.tZ)(eh,{value:null==t?void 0:t.stroke,onChange:function(e){r(e,"stroke")}})]}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u7C97\u7EC6"}),(0,i.tZ)($.Z,{min:1,max:100,value:null==t?void 0:t.strokeWidth,onChange:function(e){r(e,"strokeWidth")}})]}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u5706\u89D2"}),(0,i.tZ)($.Z,{min:0,max:200,value:null==t?void 0:t.borderRadius,onChange:function(e){r(e,"borderRadius")}})]})]}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:"\u8FB9\u6846"})})}var t_=n(6246),tS=n.n(t_),tj=n(1702),tB=n(3892);function tR(e){var t=e.object,n=(0,s.useRef)(),r=(0,s.useRef)(null),o=(0,a._)((0,s.useState)(!1),2),l=o[0],c=o[1],h=(0,a._)((0,s.useState)({}),2),u=h[0],d=h[1],f=function(){if(r.current){var e=r.current.getCroppedCanvas().toDataURL();t.setSrc(e,function(){t.set("hasControls",!0),t.group&&t.group.addWithUpdate(),t.canvas.requestRenderAll(),t.setCoords()}),c(!1)}},v=function(e){r.current&&r.current.setAspectRatio(e)};return(0,s.useEffect)(function(){return function(){r.current&&(r.current.destroy(),r.current=null)}},[]),(0,i.BX)("div",{children:[(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){c(!0);var e=t.getBoundingRect();d({src:t.getSrc(),width:e.width,height:e.height,left:e.left+420,top:e.top+50}),setTimeout(function(){r.current=new(tS())(n.current,{scalable:!1,autoCropArea:1,viewMode:3,toggleDragModeOnDblclick:!1}),t.set("hasControls",!1),t.canvas.requestRenderAll()},66)},children:"\u88C1\u526A"}),l?(0,i.BX)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,.65)",zIndex:1e3},className:"fabritor-crop-wrapper",children:[(0,i.tZ)("div",{style:{position:"absolute",zIndex:1001,left:u.left,top:u.top-38},children:(0,i.BX)(M.Z.Compact,{block:!0,children:[(0,i.tZ)(y.ZP,{onClick:function(){v(1)},children:"1:1"}),(0,i.tZ)(y.ZP,{onClick:function(){v(4/3)},children:"4:3"}),(0,i.tZ)(y.ZP,{onClick:function(){v(3/4)},children:"3:4"}),(0,i.tZ)(y.ZP,{onClick:function(){v(16/9)},children:"16:9"}),(0,i.tZ)(y.ZP,{onClick:function(){v(9/16)},children:"9:16"}),(0,i.tZ)(y.ZP,{icon:(0,i.tZ)(tj.Z,{}),onClick:function(){c(!1),t.set("hasControls",!0),t.canvas.requestRenderAll()}}),(0,i.tZ)(y.ZP,{icon:(0,i.tZ)(tB.Z,{}),onClick:f})]})}),(0,i.tZ)("div",{style:{width:u.width,height:u.height,position:"absolute",zIndex:1001,left:u.left,top:u.top},onDoubleClick:f,children:(0,i.tZ)("img",{ref:n,src:u.src,style:{display:"block",maxWidth:"100%"}})})]}):null]})}var tz=K.Z.Item,tH=function(e){var t=e.stroke,n=e.strokeWidth,r=e.strokeDashArray;if(!t)return"none";if(null==r?void 0:r.length){var i=(0,a._)(r,2),o=i[0],l=i[1];return[o/=n/2>1?n/2:n,l/=n/4>1?n/4:n].join(",")}return"line"},tL=function(e){var t=e.type,n=e.strokeWidth;if(!t)return null;if("line"!==t){var r=t.split(",");return r[0]=r[0]*(n/2>1?n/2:n),r[1]=r[1]*(n/4>1?n/4:n),r}return null};function tO(){var e=(0,s.useContext)(ef),t=e.object,n=e.setFxType,r=(0,a._)(K.Z.useForm(),1)[0],o=function(e){var n=(0,J.o)();e&&t.setSrc(e,function(){n.canvas.requestRenderAll()})},l=function(e){var n=(0,J.o)(),r=e||{},i=r.type,o=r.stroke,a=r.strokeWidth,l=r.borderRadius;"none"===i?t.setBorder({stroke:null,borderRadius:l}):t.setBorder({stroke:void 0===o?"#000000":o,strokeWidth:a,borderRadius:l,strokeDashArray:tL(e)}),n.canvas.requestRenderAll()};return(0,s.useEffect)(function(){if(t){var e=t.getBorder();r.setFieldsValue({border:(0,z._)((0,R._)({type:tH(e)},e),{stroke:e.stroke||"#000000"}),opacity:t.opacity})}},[t]),(0,i.BX)(K.Z,{layout:"inline",form:r,onValuesChange:function(e){var n=(0,J.o)();e.img&&o(e.img),e.flip&&(t.set(e.flip,!t[e.flip]),n.canvas.requestRenderAll()),e.border&&l(e.border),n.fireCustomModifiedEvent()},className:"fabritor-toolbar-form",children:[(0,i.tZ)(tz,{name:"img",children:(0,i.tZ)(tZ,{})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tz,{name:"flip",children:(0,i.tZ)(tk,{})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tz,{name:"border",children:(0,i.tZ)(tC,{})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tz,{children:(0,i.tZ)(tR,{object:t})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tz,{children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){n("image")},children:(0,i.tZ)(tp.Z,{style:{fontSize:22}})})}),(0,i.tZ)(ty,{})]})}var tP=n(8643),tM=n(4160);function tF(e){var t=e.value,n=e.onChange,r=(0,a._)((0,s.useState)([]),2),o=r[0],l=r[1],c=function(e,t){var n=(0,tM._)(o);n[t]=e,l(n)};return(0,s.useEffect)(function(){l(t)},[t]),(0,i.tZ)(P.Z,{content:(0,i.BX)(M.Z,{children:["\u5BBD\u5EA6\uFF1A",(0,i.tZ)(eJ.Z,{value:null==o?void 0:o[0],onChange:function(e){c(e,0)}}),"\u9AD8\u5EA6\uFF1A",(0,i.tZ)(eJ.Z,{value:null==o?void 0:o[1],onChange:function(e){c(e,1)}}),(0,i.tZ)(y.ZP,{type:"primary",onClick:function(){n(o)},children:"\u786E\u8BA4"})]}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:"\u753B\u5E03\u5C3A\u5BF8"})})}var tA=n(570),tX=n(6418),tE=K.Z.Item;function tT(){var e=(0,a._)(K.Z.useForm(),1)[0],t=(0,s.useContext)(ef).setActiveObject;return(0,s.useEffect)(function(){var t=(0,J.o)();if(t){var n=t.sketch;e.setFieldsValue({fill:n.fill,size:[n.width,n.height]})}},[]),(0,i.BX)(K.Z,{layout:"inline",form:e,onValuesChange:function(e){var t=(0,J.o)(),n=t.sketch,r=t.canvas;Object.keys(e).forEach(function(i){"size"===i?t.setSketchSize({width:e[i][0],height:e[i][1]}):(n.set(i,e[i]),r.requestRenderAll())}),t.fireCustomModifiedEvent()},className:"fabritor-toolbar-form",children:[(0,i.tZ)(tE,{name:"fill",children:(0,i.tZ)(eR,{type:"sketch"})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tE,{name:"size",children:(0,i.tZ)(tF,{})}),(0,i.tZ)(ty,{}),(0,i.tZ)(tE,{children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){tP.Z.confirm({title:"\u786E\u8BA4\u6E05\u7A7A\u753B\u5E03\uFF1F",icon:(0,i.tZ)(tA.Z,{}),onOk(){return(0,o._)(function(){var e;return(0,l.Jh)(this,function(n){switch(n.label){case 0:return[4,(e=(0,J.o)()).clearCanvas()];case 1:return n.sent(),t(e.sketch),[2]}})})()},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,i.tZ)(tX.Z,{style:{fontSize:20}})})})]})}var tV=[{key:"line",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x2="24" y1="50%" y2="50%" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"12,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="-1" x2="25" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="12 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"6,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="6 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"2,2",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="2 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'}];function tI(e){var t=e.value,n=e.onChange,r=e.borderTypesDisabled,o=function(e,r){n&&n((0,z._)((0,R._)({},t),{[r]:e}))};return(0,i.tZ)(P.Z,{content:(0,i.BX)(u.Z,{vertical:!0,gap:8,children:[(0,i.tZ)(eq.ZP.Group,{value:null==t?void 0:t.type,onChange:function(e){o(e.target.value,"type")},disabled:r,children:tV.map(function(e){return(0,i.tZ)(eq.ZP.Button,{value:e.key,children:(0,i.tZ)("span",{dangerouslySetInnerHTML:{__html:e.svg},style:{display:"inline-flex",alignItems:"center",marginTop:3}})},e.key)})}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u7C97\u7EC6"}),(0,i.tZ)($.Z,{min:1,max:100,value:null==t?void 0:t.strokeWidth,onChange:function(e){o(e,"strokeWidth")}})]}),(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u5706\u89D2"}),(0,i.tZ)(ez.Z,{checked:null==t?void 0:t.round,onChange:function(e){o(e,"round")}})]})]}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:"\u7EBF\u6BB5"})})}var tN=K.Z.Item;function tW(){var e=(0,s.useContext)(ef).object,t=(0,a._)(K.Z.useForm(),1)[0],n=function(e,t,n){if(!e)return"none";if(null==n?void 0:n.length){var r=(0,a._)(n,2),i=r[0],o=r[1];return[i/=t,o/=t].join(",")}return"line"},r=function(t){if(t){var n=t.strokeWidth,r=void 0===n?1:n,i=t.round,o=void 0!==i&&i,a=t.type,l=void 0===a?"line":a;if(e.setStrokeWidth(r),e.set("strokeLineCap",o?"round":"butt"),"line"!==l){var s=l.split(",");s[0]=s[0]*r,s[1]=s[1]*r,e.set("strokeDashArray",s)}else e.set("strokeDashArray",null)}};return(0,s.useEffect)(function(){t.setFieldsValue({stroke:e.stroke,strokeConfig:{type:n(e.stroke,e.strokeWidth,e.strokeDashArray),strokeWidth:e.strokeWidth,round:"round"===e.strokeLineCap}})},[e]),(0,i.BX)(K.Z,{form:t,onValuesChange:function(t){var n=Object.keys(t);if(null==n?void 0:n.length){var i=!0,o=!1,a=void 0;try{for(var l,s=n[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;switch(c){case"stroke":e.set("stroke",t[c]);break;case"strokeConfig":r(t[c])}}}catch(u){o=!0,a=u}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}e.setCoords();var h=(0,J.o)();h.canvas.requestRenderAll(),h.fireCustomModifiedEvent()}},layout:"inline",children:[(0,i.tZ)(tN,{name:"stroke",children:(0,i.tZ)(eh,{})}),(0,i.tZ)(tN,{name:"strokeConfig",children:(0,i.tZ)(tI,{borderTypesDisabled:(null==e?void 0:e.sub_type)==="arrow"})})]})}var tD=K.Z.Item,tJ=function(e,t,n){if(!e)return"none";if(null==n?void 0:n.length){var r=(0,a._)(n,2),i=r[0],o=r[1];return[i/=t/2>1?t/2:t,o/=t/4>1?t/4:t].join(",")}return"line"};function tU(){var e=(0,s.useContext)(ef).object,t=(0,a._)(K.Z.useForm(),1)[0],n=function(t){var n=(0,J.o)(),r=t||{},i=r.type,o=r.stroke,a=r.strokeWidth,l=r.borderRadius;if("none"===i)e.set("stroke",null),e.set("strokeWidth",1);else if(e.set("stroke",void 0===o?"#000":o),e.set("strokeWidth",a),"line"!==i){var s=i.split(",");s[0]=s[0]*(a/2>1?a/2:a),s[1]=s[1]*(a/4>1?a/4:a),e.set("strokeDashArray",s)}else e.set("strokeDashArray",null);"rect"===e.type?(e.set("rx",l),e.set("ry",l)):e.set("strokeLineJoin",l>0?"round":"miter"),e.setCoords(),n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()};return(0,s.useEffect)(function(){e&&t.setFieldsValue({border:{type:tJ(e.stroke,e.strokeWidth,e.strokeDashArray),stroke:e.stroke||"#000000",strokeWidth:e.strokeWidth||1,borderRadius:e.rx||e.ry||("round"===e.strokeLineJoin?100:0)},fill:e.fill})},[e]),(0,i.BX)(K.Z,{form:t,onValuesChange:function(t){var r=(0,J.o)();t.fill&&(e.set("fill",t.fill),r.canvas.requestRenderAll()),t.border&&n(t.border)},layout:"inline",children:[(0,i.tZ)(tD,{children:(0,i.tZ)(eR,{defaultColor:"#000000"})}),(0,i.tZ)(tD,{name:"border",children:(0,i.tZ)(tC,{})})]})}var tq=n(5936),tY=n(1993),tG=n(2541);function tK(e){var t=e.value,n=e.onChange;return(0,i.tZ)(P.Z,{content:(0,i.BX)(M.Z,{direction:"vertical",children:[(0,i.tZ)("span",{children:"\u900F\u660E\u5EA6"}),(0,i.tZ)($.Z,{style:{width:200},min:0,max:1,step:.01,value:t,onChange:n})]}),placement:"bottom",trigger:"click",children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",children:(0,i.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:(0,i.BX)("g",{fill:"currentColor","fill-rule":"evenodd",children:[(0,i.tZ)("path",{d:"M3 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z"}),(0,i.tZ)("path",{d:"M11 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".45"}),(0,i.tZ)("path",{d:"M19 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".15"}),(0,i.tZ)("path",{d:"M7 6h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".7"}),(0,i.tZ)("path",{d:"M15 6h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".3"})]})})})})}var tQ=n(2879).Z.Title;function t$(){var e=(0,a._)((0,s.useState)(""),2),t=e[0],n=e[1];return(0,s.useEffect)(function(){var e=(0,J.o)();e&&n(e.sketch.fabritor_desc)},[]),(0,i.tZ)(tQ,{level:5,editable:{onChange:function(e){n(e);var t=(0,J.o)();t&&t.sketch.set("fabritor_desc",e)}},style:{margin:0,fontSize:16},children:t||""})}var t0=K.Z.Item;function t1(){var e=(0,s.useContext)(ef),t=e.object,n=e.isReady,r=(0,a._)((0,s.useState)(!1),2),o=r[0],l=r[1],c=(0,a._)((0,s.useState)(1),2),h=c[0],u=c[1],d=(0,a._)((0,s.useState)(!1),2),f=d[0],v=d[1];return(0,s.useEffect)(function(){t&&(l(null==t?void 0:t.lockMovementX),u(null==t?void 0:t.opacity))},[t]),(0,i.BX)(eS.Fragment,{children:[(0,i.BX)(K.Z,{layout:"inline",className:"fabritor-toolbar-form-text",children:[t&&t.id!==em.vH?(0,i.tZ)(t0,{children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){var e=(0,J.o)();t.set({lockMovementX:!o,lockMovementY:!o,hasControls:!!o}),e.canvas.requestRenderAll(),l(!o),e.fireCustomModifiedEvent()},children:o?(0,i.tZ)(tY.Z,{style:{fontSize:22}}):(0,i.tZ)(tG.Z,{style:{fontSize:22}})})}):null,t&&t.id!==em.vH?(0,i.tZ)(t0,{children:(0,i.tZ)(tK,{value:h,onChange:function(e){var n=(0,J.o)();t.set("opacity",e),u(e),n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()}})}):null]}),(0,i.BX)(K.Z,{layout:"inline",className:"fabritor-toolbar-form-text",style:{marginLeft:"auto"},children:[(0,i.tZ)(t0,{children:(0,i.tZ)("span",{className:"fabritor-toolbar-setter-trigger",onClick:function(){v((0,J.o)().switchEnablePan())},children:f?(0,i.tZ)(tq.Z,{style:{fontSize:22,color:f?"#000":"#ccc"}}):(0,i.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(el)),style:{width:22,height:22}})})}),n?(0,i.tZ)(t0,{children:(0,i.tZ)(t$,{})}):null]})]})}function t3(){var e,t=(0,s.useContext)(ef),n=t.object,r=t.isReady,o=(null==n?void 0:null===(e=n.get)||void 0===e?void 0:e.call(n,"type"))||"";return console.log("objectType",o,n),(0,i.BX)(u.Z,{className:"fabritor-toolbar",align:"center",wrap:"nowrap",children:[function(){if(!r)return null;if(!n||n.id===em.vH)return(0,i.tZ)(tT,{});switch(o){case"textbox":case"f-text":return(0,i.tZ)(tb,{});case"rect":case"circle":case"triangle":case"polygon":case"ellipse":return(0,i.tZ)(tU,{});case"line":case"f-line":return(0,i.tZ)(tW,{});case"f-image":case"image":return(0,i.tZ)(tO,{});case"path":case"group":return null;default:return(0,i.tZ)(tT,{})}}(),(0,i.tZ)(t1,{})]})}var t2=n(7871),t6=n(3232),t4=n(9122),t5=n(6012),t8=V.fabric.controlsUtils,t7=function(){var e=V.fabric.Object.prototype.controls;if(V.fabric.Rect){var t=V.fabric.Rect.prototype.controls={};t.tr=e.tr,t.br=e.br,t.tl=e.tl,t.bl=e.bl,t.mt=e.mt,t.mb=e.mb,t.mtr=e.mtr,t.copy=e.copy,t.del=e.del,t.ml=new V.fabric.Control({x:-.5,y:0,actionHandler:t8.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),t.mr=new V.fabric.Control({x:.5,y:0,actionHandler:t8.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render}),t.mt=new V.fabric.Control({x:0,y:-.5,offsetY:-1,actionHandler:q.jF,cursorStyleHandler:e.mt.cursorStyleHandler,actionName:"resizing",render:e.mt.render}),t.mb=new V.fabric.Control({x:0,y:.5,offsetY:1,actionHandler:q.jF,cursorStyleHandler:e.mb.cursorStyleHandler,actionName:"resizing",render:e.mb.render})}},t9=function(e,t,n,r){var i=t.target,o=t.originX,a=t.originY,l=i.left,s=i.top,c=i.width,h=(0,q.qc)(t,o,a,n,r);return h.x<0&&(l+=h.x+c),i.setEndX(Math.abs(h.x)),i.set({left:l,top:s,dirty:!0}),i.setCoords(),!0},ne=function(){var e=V.fabric.Object.prototype.controls;if(V.fabric.FLine){var t=V.fabric.FLine.prototype.controls={};t.mtr=e.mtr,t.copy=e.copy,t.del=e.del,t.ml=new V.fabric.Control({x:-.5,y:0,actionHandler:t9,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.bl.render}),t.mr=new V.fabric.Control({x:.5,y:0,actionHandler:t9,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.br.render})}},nt=V.fabric.controlsUtils,nn=function(){var e=V.fabric.Object.prototype.controls;if(V.fabric.Rect){var t=V.fabric.FText.prototype.controls={};t.tr=e.tr,t.br=e.br,t.tl=e.tl,t.bl=e.bl,t.mtr=e.mtr,t.copy=e.copy,t.del=e.del,t.ml=new V.fabric.Control({x:-.5,y:0,offsetX:-1,actionHandler:nt.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),t.mr=new V.fabric.Control({x:.5,y:0,offsetX:1,actionHandler:nt.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render})}},nr=document.createElement("img");nr.src=ee;var ni=document.createElement("img");ni.src=et;var no=document.createElement("img");no.src=er;var na=document.createElement("img");na.src=ei;var nl=document.createElement("img");nl.src=eo;var ns=document.createElement("img");ns.src=ea;var nc=function(e,t,n,r,i,o){var a="TB"===o?20:6,l="TB"===o?6:20;e.save(),e.fillStyle="#ffffff",e.strokeStyle="#bbbbbb",e.lineWidth=2,e.shadowBlur=2,e.shadowColor="#dddddd",e.translate(t,n),e.rotate(V.fabric.util.degreesToRadians(i.angle)),e.beginPath(),e.roundRect(-a/2,-l/2,a,l,10),e.stroke(),e.fill(),e.restore()},nh=function(e,t,n,r,i){nc(e,t,n,r,i,"LR")},nu=function(e,t,n,r,i){nc(e,t,n,r,i,"TB")},nd=function(e,t,n,r,i){e.save(),e.fillStyle="#ffffff",e.strokeStyle="#bbbbbb",e.lineWidth=2,e.shadowBlur=2,e.shadowColor="#dddddd",e.beginPath(),e.arc(t,n,6,0,2*Math.PI,!1),e.stroke(),e.fill(),e.restore()};function nf(e){return function(t,n,r,i,o){t.save(),t.translate(n,r),t.rotate(V.fabric.util.degreesToRadians(o.angle)),t.drawImage(e,-14,-14,28,28),t.restore()}}var nv=(r=(0,o._)(function(e,t){var n,r;return(0,l.Jh)(this,function(e){switch(e.label){case 0:return r=(n=t.target).canvas,[4,(0,q.Zw)(r,n)];case 1:return e.sent(),(0,q.RI)(r),[2,!0]}})}),function(e,t){return r.apply(this,arguments)}),np=function(e,t){var n=t.target,r=n.canvas;return(0,q.GZ)(n,r),!0},ng=function(){var e={x:0,y:-.5,offsetY:-1,render:nu};Object.keys(e).forEach(function(t){V.fabric.Object.prototype.controls.mt[t]=e[t]});var t={x:0,y:.5,offsetY:1,render:nu};Object.keys(t).forEach(function(e){V.fabric.Object.prototype.controls.mb[e]=t[e]});var n={x:-.5,y:0,offsetX:-1,render:nh};Object.keys(n).forEach(function(e){V.fabric.Object.prototype.controls.ml[e]=n[e]});var r={x:.5,y:0,offsetX:1,render:nh};Object.keys(r).forEach(function(e){V.fabric.Object.prototype.controls.mr[e]=r[e]});var i={x:-.5,y:-.5,render:nd};Object.keys(i).forEach(function(e){V.fabric.Object.prototype.controls.tl[e]=i[e]});var o={x:.5,y:-.5,render:nd};Object.keys(o).forEach(function(e){V.fabric.Object.prototype.controls.tr[e]=o[e]});var a={x:-.5,y:.5,render:nd};Object.keys(a).forEach(function(e){V.fabric.Object.prototype.controls.bl[e]=a[e]});var l={x:.5,y:.5,render:nd};Object.keys(l).forEach(function(e){V.fabric.Object.prototype.controls.br[e]=l[e]})},nm=function(){var e={x:0,y:.5,offsetY:38,cursorStyleHandler:function(){return'url("data:image/svg+xml;charset=utf-8,'.concat(en,'") 12 12, crosshair')},render:nf(nr),withConnection:!1};Object.keys(e).forEach(function(t){V.fabric.Object.prototype.controls.mtr[t]=e[t]})},nb=function(){var e=new V.fabric.Control({x:0,y:-.5,offsetX:-24,offsetY:-26,cursorStyle:"pointer",mouseUpHandler:nv,render:nf(no)});V.fabric.Object.prototype.controls.copy=e;var t=new V.fabric.Control({x:0,y:-.5,offsetX:24,offsetY:-26,cursorStyle:"pointer",mouseUpHandler:np,render:nf(nl)});V.fabric.Object.prototype.controls.del=t},ny=function(e,t){"mtr"===e&&(t.controls[e].render=nf(ni)),"copy"===e&&(t.controls[e].render=nf(na)),"del"===e&&(t.controls[e].render=nf(ns)),t.canvas.requestRenderAll()},nZ=function(e){e&&(e.controls.mtr.render=nf(nr),e.controls.copy.render=nf(no),e.controls.del.render=nf(nl))},nw=function(){Object.keys(em.b1).forEach(function(e){V.fabric.Object.prototype[e]=em.b1[e]});var e={borderColor:"#cccddd",borderDashArray:[7,10],borderScaleFactor:3,padding:10};Object.keys(e).forEach(function(t){V.fabric.ActiveSelection.prototype[t]=e[t],V.fabric.Group.prototype[t]=e[t]}),V.fabric.Group.prototype.subTargetCheck=!0},nk=n(1292),nx=n(9202),nC=function(){function e(t){(0,t2._)(this,e),(0,t4._)(this,"historyUndo",void 0),(0,t4._)(this,"historyRedo",void 0),(0,t4._)(this,"currentState",void 0),(0,t4._)(this,"historyProcessing",void 0),(0,t4._)(this,"canvas",void 0),(0,t4._)(this,"editor",void 0),this.historyUndo=[],this.historyRedo=[],this.canvas=t.canvas,this.editor=t,this.historyProcessing=!1,this.currentState=this._getJSON(),this.init()}return(0,t6._)(e,[{key:"_checkHistoryUndoLength",value:function(){this.historyUndo.length>100&&this.historyUndo.shift()}},{key:"_checkHistoryRedoLength",value:function(){this.historyRedo.length>100&&this.historyRedo.shift()}},{key:"_historySaveAction",value:function(){if(!this.historyProcessing){var e=this.currentState;this.historyUndo.push(e),this._checkHistoryUndoLength();var t=this._getJSON();this.currentState=t}}},{key:"_getJSON",value:function(){return JSON.stringify(this.editor.canvas2Json())}},{key:"_historyEvents",value:function(){var e=this;return{"object:added":function(t){var n=t.target;n&&n.id!==em.vH&&e._historySaveAction()},"object:removed":this._historySaveAction.bind(this),"object:modified":function(t){var n=t.target;n&&n.id!==em.vH&&e._historySaveAction()},"object:skewing":this._historySaveAction.bind(this),"fabritor:object:modified":this._historySaveAction.bind(this)}}},{key:"init",value:function(){this.canvas.on(this._historyEvents())}},{key:"dispose",value:function(){this.canvas.off(this._historyEvents())}},{key:"undo",value:function(){var e=this;return(0,o._)(function(){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!(t=e.historyUndo.pop()))return[3,2];return e.historyProcessing=!0,e.historyRedo.push(e.currentState),e._checkHistoryRedoLength(),e.currentState=t,[4,e.editor.loadFromJSON(t)];case 1:n.sent(),e.historyProcessing=!1,e.canvas.fire("fabritor:history:undo"),n.label=2;case 2:return[2]}})})()}},{key:"redo",value:function(){var e=this;return(0,o._)(function(){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!(t=e.historyRedo.pop()))return[3,2];return e.historyProcessing=!0,e.historyUndo.push(e.currentState),e._checkHistoryUndoLength(),e.currentState=t,[4,e.editor.loadFromJSON(t)];case 1:n.sent(),e.historyProcessing=!1,e.canvas.fire("fabritor:history:redo"),n.label=2;case 2:return[2]}})})()}},{key:"clear",value:function(){this.historyRedo=[],this.historyUndo=[],this.historyProcessing=!1}}]),e}(),n_=function(e){var t=e.items,n=(0,D._)(e,["items"]),r=(0,J.o)().canvas,i=new V.fabric.Group(t,(0,R._)({id:(0,U.Vj)()},n));return r.add(i),i},nS=function(){V.fabric.FLine=V.fabric.util.createClass(V.fabric.Path,{type:"f-line",padding:2,initialize(e){var t=e.start,n=e.end,r=e.arrow,i=void 0===r?[]:r,o=e.left,a=e.top;this.setOptions((0,R._)({arrowDelta:15},e)),this._setPath([["M"].concat((0,tM._)(t)),["L"].concat((0,tM._)(n))].concat((0,tM._)(i))),this.set({left:o,top:a})},setStartX(e){var t=this.path;t[0][1]=e,this._setPath(t)},setEndX(e){var t=this,n=this.path,r=n.slice(2);n[1][1]=e,r&&r.length&&r.forEach(function(n,r){r===t.middleIndex?n[1]=e:n[1]=e-t.arrowDelta}),this._setPath([n[0],n[1]].concat((0,tM._)(r)))},setStrokeWidth(e){var t=this,n=this.left,r=this.top,i=this.path,o=this.strokeWidth,a=i.slice(2),l=e-o;this.set("strokeWidth",e),a&&a.length&&(a.forEach(function(e,n){n!==t.middleIndex&&(e[1]-=l,e[2]>0?e[2]+=l:e[2]-=l)}),this.arrowDelta=a[this.middleIndex][1]-a[0][1]),this._setPath([i[0],i[1]].concat((0,tM._)(a))),this.set({left:n,top:r})},setStrokeDashArray(e){this.set("strokeDashArray",e)}}),V.fabric.FLine.fromObject=function(e,t){var n=(0,R._)({},e),r=e.path;n.arrow=r.slice(2),n.start=r[0].slice(1),n.end=r[1].slice(1),V.fabric.Object._fromObject("FLine",n,t)},V.fabric.FLine.ATTRIBUTE_NAMES=V.fabric.Path.ATTRIBUTE_NAMES},nj=V.fabric.util.object.clone,nB="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign minWidth splitByGrapheme".split(" "),nR=function(){V.fabric.FText=V.fabric.util.createClass(V.fabric.Textbox,{type:"f-text",padding:4,paintFirst:"stroke",initDimensions:function(){if(!this.__skipDimension){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces();var e=this.calcTextHeight();this.path?this.height=this.path.height>e?this.path.height:e:this.height=e,this.saveState({propertySet:"_dimensionAffectingProps"})}},toObject:function(e){var t=nB.concat(e),n=this.callSuper("toObject",t);return n.styles=V.fabric.util.stylesToArray(this.styles,this.text),n.path&&(n.path=this.path.toObject()),n}}),V.fabric.FText.fromObject=function(e,t){var n=nj(e),r=e.path;return delete n.path,V.fabric.Object._fromObject("FText",n,function(n){n.styles=V.fabric.util.stylesFromArray(e.styles,e.text),r?V.fabric.Object._fromObject("Path",r,function(e){n.set("path",e),t(n)},"path"):t(n)},"text")}};(0,o._)(function(e){return(0,l.Jh)(this,function(t){return"string"==typeof e?[2,new Promise(function(t,n){V.fabric.Image.fromURL(e,function(e){if(!e){t5.ZP.error("\u52A0\u8F7D\u8FDC\u7A0B\u56FE\u7247\u5931\u8D25"),n();return}t(e)},{crossOrigin:"anonymous"})})]:[2,Promise.resolve(new V.fabric.Image(e))]})});var nz=function(){var e;e=V.fabric.util.createClass(V.fabric.Group,{type:"f-image",initialize(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.image,r=e.imageBorder,i=void 0===r?{}:r,o=(0,D._)(e,["image","imageBorder"]);n.set({originX:"center",originY:"center"}),this.img=n,this.borderRect=this._createBorderRect(i),this.img.clipPath=this._createClipPath(),this.callSuper("initialize",[this.img,this.borderRect],(0,R._)({borderColor:"#FF2222",borderDashArray:null,borderScaleFactor:2,padding:0,subTargetCheck:!1,imageBorder:i},o),t)},_createBorderRect(e){var t=e.stroke,n=e.strokeWidth,r=e.borderRadius,i={width:this.img.getScaledWidth(),height:this.img.getScaledHeight(),rx:r||0,ry:r||0,originX:"center",originY:"center",fill:"#00000000",paintFirst:"fill"};return t&&(i.stroke=t),n&&(i.strokeWidth=n),new V.fabric.Rect(i)},_createClipPath(){var e=this.img.width,t=this.img.height;return console.log(e,t),new V.fabric.Rect({originX:"center",originY:"center",width:e,height:t,rx:this.borderRect.rx||0,ry:this.borderRect.ry||0})},setSrc(e,t){var n=this;this.img.setSrc(e,function(){var e=n.img.getScaledWidth(),r=n.img.getScaledHeight();n.img.setCoords(),n.borderRect.set({width:e,height:r,dirty:!0}),n.img.set({clipPath:n._createClipPath(),dirty:!0}),n.addWithUpdate(),t&&t()})},getSrc(){return this.img.getSrc()},setBorder(e){this.borderRect.set({stroke:e.stroke||null,strokeWidth:e.strokeWidth||1,rx:e.borderRadius||0,ry:e.borderRadius||0,strokeDashArray:e.strokeDashArray||null}),this.img.setCoords(),this.img.set({clipPath:this._createClipPath(),dirty:!0}),this.imageBorder=(0,R._)({},e),this.addWithUpdate()},getBorder(){return this.imageBorder},applyFilter(e){try{this.img.filters=e?[e]:[],this.img.applyFilters()}catch(t){console.log(t)}},applyFilterValue(e,t){var n=this.getFilter();n&&(n[e]=t,this.img.filters=[n],this.img.applyFilters())},getFilter(){return this.img.filters[0]}}),V.fabric.FImage=e,V.fabric.FImage.fromObject=function(e,t){var n=e.objects,r=(0,D._)(e,["objects"]),i=(0,R._)({},n[0]);V.fabric.Image.fromObject(i,function(e){t(new V.fabric.FImage((0,R._)({image:e},r),!0))})}},nH=function(){function e(t){(0,t2._)(this,e),(0,t4._)(this,"canvas",void 0),(0,t4._)(this,"_options",void 0),(0,t4._)(this,"_template",void 0),(0,t4._)(this,"sketch",void 0),(0,t4._)(this,"_resizeObserver",void 0),(0,t4._)(this,"_pan",void 0),(0,t4._)(this,"fhistory",void 0),(0,t4._)(this,"canSaveLocal",void 0);var n=t.template,r=(0,D._)(t,["template"]);this._options=r,this._template=n,this.canSaveLocal=!1,this._pan={enable:!1,isDragging:!1,lastPosX:0,lastPosY:0}}return(0,t6._)(e,[{key:"init",value:function(){var e=this;return(0,o._)(function(){return(0,l.Jh)(this,function(t){switch(t.label){case 0:var n,r,i;return e._initObject(),e._initCanvas(),e._initEvents(),e._initSketch(),e._initGuidelines(),e.fhistory=new nC(e),n=e.canvas,r=e.fhistory,(0,nx.Z)("ctrl+c,command+c",(i=(0,o._)(function(e){return(0,l.Jh)(this,function(e){switch(e.label){case 0:return[4,(0,q.Zw)(n,null)];case 1:return e.sent(),[2]}})}),function(e){return i.apply(this,arguments)})),(0,nx.Z)("ctrl+v,command+v",function(e){(0,q.RI)(n)}),(0,nx.Z)("delete,del,backspace",function(e){e.preventDefault(),(0,q.GZ)(null,n)}),(0,nx.Z)("ctrl+z,command+z",function(e){e.preventDefault(),r.undo()}),(0,nx.Z)("ctrl+shift+z,command+shift+z",function(e){e.preventDefault(),r.redo()}),(0,nx.Z)("up, right, down, left",function(e,t){var r=n.getActiveObject();if(r&&("f-text"!==r.type||!r.isEditing)){switch(e.preventDefault(),t.key){case"up":r.set("top",r.top-1);break;case"right":r.set("left",r.left+1);break;case"down":r.set("top",r.top+1);break;case"left":r.set("left",r.left-1)}r.group&&r.addWithUpdate(),n.requestRenderAll()}}),[4,e._loadLocal()];case 1:return t.sent(),e.canSaveLocal=!0,e._save2Local(),[2]}})})()}},{key:"_initObject",value:function(){nS(),nR(),nz(),ng(),nm(),nb(),t7(),ne(),nn(),nw()}},{key:"_initCanvas",value:function(){var e=this._options,t=e.canvasEl,n=e.workspaceEl;this.canvas=new V.fabric.Canvas(t,{selection:!0,containerClass:"fabritor-canvas",enableRetinaScaling:!0,fireRightClick:!0,controlsAboveOverlay:!0,width:n.offsetWidth,height:n.offsetHeight,backgroundColor:"#ddd",preserveObjectStacking:!0})}},{key:"_initGuidelines",value:function(){var e,t,n,r,i,o,a,l,s,c,h,u,d;e=this.canvas,t=function(e){r(e.x+.5,e.y1>e.y2?e.y2:e.y1,e.x+.5,e.y2>e.y1?e.y2:e.y1)},n=function(e){r(e.x1>e.x2?e.x2:e.x1,e.y+.5,e.x2>e.x1?e.x2:e.x1,e.y+.5)},r=function(e,t,n,r){a.save(),a.lineWidth=s,a.strokeStyle=c,a.beginPath(),a.moveTo(e*h+o[4],t*h+o[5]),a.lineTo(n*h+o[4],r*h+o[5]),a.stroke(),a.restore()},i=function(e,t){e=Math.round(e),t=Math.round(t);for(var n=e-l,r=e+l;n<=r;n++)if(n===t)return!0;return!1},a=e.getSelectionContext(),l=4,s=1,c="rgb(0,255,0)",h=1,u=[],d=[],e.on("mouse:down",function(){o=e.viewportTransform,h=e.getZoom()}),e.on("object:moving",function(t){var n=t.target,r=e.getObjects(),a=n.getCenterPoint(),l=a.x,s=a.y,c=n.getBoundingRect(),h=c.height/o[3],f=c.width/o[0],v=!1,p=!1;if(e._currentTransform){for(var g=r.length;g--;)if(r[g]!==n){var m=r[g].getCenterPoint(),b=m.x,y=m.y,Z=r[g].getBoundingRect(),w=Z.height/o[3],k=Z.width/o[0];i(b,l)&&(p=!0,u.push({x:b,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+h/2+5:s-h/2-5}),n.setPositionByOrigin(new fabric.Point(b,s),"center","center")),i(b-k/2,l-f/2)&&(p=!0,u.push({x:b-k/2,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+h/2+5:s-h/2-5}),n.setPositionByOrigin(new fabric.Point(b-k/2+f/2,s),"center","center")),i(b+k/2,l+f/2)&&(p=!0,u.push({x:b+k/2,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+h/2+5:s-h/2-5}),n.setPositionByOrigin(new fabric.Point(b+k/2-f/2,s),"center","center")),i(y,s)&&(v=!0,d.push({y:y,x1:b<l?b-k/2-5:b+k/2+5,x2:l>b?l+f/2+5:l-f/2-5}),n.setPositionByOrigin(new fabric.Point(l,y),"center","center")),i(y-w/2,s-h/2)&&(v=!0,d.push({y:y-w/2,x1:b<l?b-k/2-5:b+k/2+5,x2:l>b?l+f/2+5:l-f/2-5}),n.setPositionByOrigin(new fabric.Point(l,y-w/2+h/2),"center","center")),i(y+w/2,s+h/2)&&(v=!0,d.push({y:y+w/2,x1:b<l?b-k/2-5:b+k/2+5,x2:l>b?l+f/2+5:l-f/2-5}),n.setPositionByOrigin(new fabric.Point(l,y+w/2-h/2),"center","center"))}v||(d.length=0),p||(u.length=0)}}),e.on("before:render",function(){e.contextTop&&e.clearContext(e.contextTop)}),e.on("after:render",function(){for(var e=u.length;e--;)t(u[e]);for(var e=d.length;e--;)n(d[e]);u.length=d.length=0}),e.on("mouse:up",function(){u.length=d.length=0,e.renderAll()}),function(e){for(var t,n,r,i=function(){a(c+.5,0,c+.5,s)},o=function(){a(0,h+.5,l,h+.5)},a=function(e,t,n,i){p.save(),p.strokeStyle=f,p.lineWidth=v,p.beginPath(),p.moveTo(e*r[0],t*r[3]),p.lineTo(n*r[0],i*r[3]),p.stroke(),p.restore()},l=e.getWidth(),s=e.getHeight(),c=l/2,h=s/2,u={},d={},f="rgba(255,0,241,0.5)",v=1,p=e.getSelectionContext(),g=c-4,m=c+4;g<=m;g++)u[Math.round(g)]=!0;for(var g=h-4,m=h+4;g<=m;g++)d[Math.round(g)]=!0;e.on("mouse:down",function(){r=e.viewportTransform}),e.on("object:moving",function(r){var i=r.target,o=i.getCenterPoint();e._currentTransform&&(t=Math.round(o.x) in u,((n=Math.round(o.y) in d)||t)&&i.setPositionByOrigin(new fabric.Point(t?c:o.x,n?h:o.y),"center","center"))}),e.on("before:render",function(){e.contextTop&&e.clearContext(e.contextTop)}),e.on("after:render",function(){t&&i(),n&&o()}),e.on("mouse:up",function(){t=n=null,e.renderAll()})}(this.canvas)}},{key:"_initSketch",value:function(){var e=this._template||{},t=e.width,n=e.height,r=new V.fabric.Rect({fill:"#ffffff",left:0,top:0,width:void 0===t?1242:t,height:void 0===n?1660:n,selectable:!1,hasControls:!1,hoverCursor:"default",id:em.vH,fabritor_desc:"\u6211\u7684\u753B\u677F"});this.canvas.add(r),this.canvas.requestRenderAll(),this.sketch=r,this._initResizeObserver(),this._adjustSketch2Canvas()}},{key:"setSketchSize",value:function(e){this.sketch.set(e),this._adjustSketch2Canvas()}},{key:"_initResizeObserver",value:function(){var e=this,t=this._options.workspaceEl;this._resizeObserver=new ResizeObserver((0,nk.Z)(function(){e.canvas.setWidth(t.offsetWidth),e.canvas.setHeight(t.offsetHeight),e._adjustSketch2Canvas()},50)),this._resizeObserver.observe(t)}},{key:"_adjustSketch2Canvas",value:function(){var e=this,t=(0,q.VY)({width:this.canvas.width,height:this.canvas.height},{width:this.sketch.width,height:this.sketch.height}),n=this.canvas.getCenter();this.canvas.zoomToPoint(new V.fabric.Point(n.left,n.top),t-.04);var r=this.sketch.getCenterPoint(),i=this.canvas.viewportTransform;i[4]=this.canvas.width/2-r.x*i[0],i[5]=this.canvas.height/2-r.y*i[3],this.canvas.setViewportTransform(i),this.canvas.requestRenderAll(),this.sketch.clone(function(t){e.canvas.clipPath=t,e.canvas.requestRenderAll()})}},{key:"_initEvents",value:function(){var e=this,t=this._options.sketchEventHandler;this.canvas.on("mouse:down",function(n){if(!e._pan.enable){var r;null==t||null===(r=t.clickHandler)||void 0===r||r.call(t,n)}var i=n.e;e._pan.enable&&(e._pan={enable:!0,isDragging:!0,lastPosX:i.clientX,lastPosY:i.clientY})}),this.canvas.on("mouse:move",function(t){if(e._pan.enable&&e._pan.isDragging){var n=t.e,r=e.canvas.viewportTransform;r[4]+=n.clientX-e._pan.lastPosX,r[5]+=n.clientY-e._pan.lastPosY,e.canvas.requestRenderAll(),e._pan.lastPosX=n.clientX,e._pan.lastPosY=n.clientY}}),this.canvas.on("mouse:over",function(t){var n=t.target;if(!e._pan.enable){var r=null==n?void 0:n.__corner;r&&ny(r,t.target),n&&n.id!==em.vH&&n!==e.canvas.getActiveObject()&&n._renderControls(e.canvas.contextTop,{hasControls:!1})}}),this.canvas.on("mouse:out",function(t){var n=t.target;n&&n.id!==em.vH&&(nZ(n),e.canvas.requestRenderAll())}),this.canvas.on("mouse:up",function(n){var r;null==t||null===(r=t.mouseupHandler)||void 0===r||r.call(t,n),e._pan.enable&&(e.canvas.setViewportTransform(e.canvas.viewportTransform),e._pan.isDragging=!1)}),this.canvas.on("mouse:wheel",this._scrollSketch.bind(this)),this.canvas.on("object:rotating",null==t?void 0:t.rotateHandler),this.canvas.on("selection:created",function(e){null==t||t.selectionHandler(e)}),this.canvas.on("selection:updated",function(e){null==t||t.selectionHandler(e)}),this.canvas.on("selection:cleared",function(e){null==t||t.selectionHandler(e)}),this.canvas.on("fabritor:clone",null==t?void 0:t.cloneHandler),this.canvas.on("fabritor:del",null==t?void 0:t.delHandler),this.canvas.on("fabritor:group",null==t?void 0:t.groupHandler),this.canvas.on("fabritor:ungroup",null==t?void 0:t.groupHandler),this.canvas.on("mouse:dblclick",function(n){var r,i=n.target,o=n.subTargets,a=null==o?void 0:o[0];(null==i?void 0:i.type)==="group"&&a&&("f-text"===a.type?e._editTextInGroup(i,a):(a.set("hasControls",!1),e.canvas.discardActiveObject(),e.canvas.setActiveObject(a),e.canvas.requestRenderAll(),null==t||null===(r=t.dblObjectHandler)||void 0===r||r.call(t,a,n)))}),this.canvas.on("object:modified",function(t){var n=t.target;if(n&&n.id!==em.vH){var r=n.getScaledWidth(),i=n.getScaledHeight();"f-line"!==n.type&&"f-image"!==n.type&&("f-text"!==n.type&&(n.setControlVisible("mt",r>=100),n.setControlVisible("mb",r>=100)),n.setControlVisible("ml",i>=40),n.setControlVisible("mr",i>=40),e.canvas.requestRenderAll())}})}},{key:"_editTextInGroup",value:function(e,t){var n=this,r=e.getObjects();t.on("editing:exited",function(){for(var e=0;e<r.length;e++)n.canvas.remove(r[e]);var i=n_({items:r});n.canvas.renderAll(),n.canvas.setActiveObject(i),n.canvas.fire("fabritor:group",{target:n.canvas.getActiveObject()}),t.off("editing:exited")}),e._restoreObjectsState(),this.canvas.remove(e),this.canvas.renderAll();for(var i=0;i<r.length;i++)r[i].selectable=!1,r[i].set("hasControls",!1),this.canvas.add(r[i]);this.canvas.renderAll(),this.canvas.setActiveObject(t),t.enterEditing(),t.selectAll()}},{key:"switchEnablePan",value:function(){var e=this;return this._pan.enable=!this._pan.enable,this.canvas.discardActiveObject(),this.canvas.hoverCursor=this._pan.enable?"grab":"move",this.canvas.getObjects().forEach(function(t){t.id!==em.vH&&t.set("selectable",!e._pan.enable)}),this.canvas.selection=!this._pan.enable,this.canvas.requestRenderAll(),this._pan.enable}},{key:"fireCustomModifiedEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.canvas.fire("fabritor:object:modified",e)}},{key:"_scrollSketch",value:function(e){var t=e.e.deltaY,n=this.canvas.getZoom();(n*=Math.pow(.999,t))>20&&(n=20),n<.01&&(n=.01);var r=this.canvas.getCenter();this.canvas.zoomToPoint({x:r.left,y:r.top},n),e.e.preventDefault(),e.e.stopPropagation()}},{key:"destroy",value:function(){this.canvas&&(this.canvas.dispose(),this.canvas=null);var e=this._options.workspaceEl;this._resizeObserver&&(this._resizeObserver.unobserve(e),this._resizeObserver=null)}},{key:"export2Img",value:function(e){var t=this.canvas.viewportTransform;this.canvas.setViewportTransform([1,0,0,1,0,0]);var n=this.sketch,r=n.left,i=n.top,o=n.width,a=n.height,l=this.canvas.toDataURL((0,R._)({left:r,top:i,width:o,height:a,format:"png"},e));return this.canvas.setViewportTransform(t),l}},{key:"export2Svg",value:function(){var e=this.sketch,t=e.left,n=e.top,r=e.width,i=e.height,o=this.canvas.toSVG({width:r,height:i,viewBox:{x:t,y:n,width:r,height:i}});return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(o))}},{key:"export2Json",value:function(){var e=this.canvas2Json();return"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(e,null,2)))}},{key:"_loadLocal",value:function(){var e=this;return(0,o._)(function(){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),!(t=localStorage.getItem("fabritor_web_json")))return[3,2];return n=JSON.parse(t),[4,e.loadFromJSON(n)];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return console.log(r.sent()),[3,4];case 4:return[2]}})})()}},{key:"_save2Local",value:function(){var e=this;setInterval(function(){try{if(e.canSaveLocal){var t=e.canvas2Json();localStorage.setItem("fabritor_web_json",JSON.stringify(t))}}catch(n){console.log(n)}},2e3)}},{key:"canvas2Json",value:function(){var e=this.canvas.toJSON(em.rS);return e[em.jF]=em.bI,e}},{key:"loadFromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return(0,o._)(function(){var r,i,o,a,s,c,h,u;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(!e)return[2];if("string"==typeof e)try{e=JSON.parse(e)}catch(d){return t5.ZP.error("\u52A0\u8F7D\u672C\u5730\u6A21\u677F\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),[2]}if(e[em.jF]!==em.bI)return t5.ZP.error("\u6B64\u6A21\u677F\u5DF2\u7ECF\u65E0\u6CD5\u4E0E\u5F53\u524D\u7248\u672C\u517C\u5BB9\uFF0C\u8BF7\u66F4\u6362\u6A21\u677F"),[2];r=e.objects,i=!0,o=!1,a=void 0,l.label=1;case 1:l.trys.push([1,6,7,8]),s=r[Symbol.iterator](),l.label=2;case 2:if(i=(c=s.next()).done)return[3,5];if("f-text"!==(h=c.value).type)return[3,4];return[4,(0,U.mx)(h.fontFamily)];case 3:l.sent(),l.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return u=l.sent(),o=!0,a=u,[3,8];case 7:try{i||null==s.return||s.return()}finally{if(o)throw a}return[7];case 8:return n.fhistory.historyProcessing=!0,[2,new Promise(function(r){n.canvas.loadFromJSON(e,function(){n.canvas.requestRenderAll(),n.fhistory.historyProcessing=!1,t&&n.fhistory._historySaveAction(),r(!0)},function(e,t){t.id===em.vH&&(n.sketch=t,n.setSketchSize({width:t.width,height:t.height}))})})]}})})()}},{key:"clearCanvas",value:function(){var e=this;return(0,o._)(function(){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return e.canvas.clear(),[4,e.loadFromJSON('{"fabritor_schema_version":2,"version":"5.3.0","objects":[{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":1242,"height":1660,"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"id":"fabritor-sketch","fabritor_desc":"\u6211\u7684\u753B\u677F","selectable":false,"hasControls":false}],"clipPath":{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":1242,"height":1660,"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"selectable":true,"hasControls":true},"background":"#ddd"}')];case 1:return t.sent(),[2]}})})()}}]),e}(),nL=(0,s.forwardRef)(function(e,t){var n=(0,a._)((0,s.useState)({x:0,y:0}),2),r=n[0],o=n[1],l=(0,a._)((0,s.useState)(""),2),c=l[0],h=l[1],u=(0,a._)((0,s.useState)(!1),2),d=u[0],f=u[1];return(0,s.useImperativeHandle)(t,function(){return{show(e,t){f(!0),o(e),h(t)},close(){f(!1)}}}),(0,i.tZ)("div",{style:(0,R._)({fontSize:12,position:"fixed",zIndex:9999,width:"max-content",display:d?"block":"none"},r),children:(0,i.tZ)("div",{style:{padding:"6px 6px",color:"#fff",backgroundColor:"rgba(0, 0, 0, 0.85)",borderRadius:6},role:"tooltip",children:c})})}),nO=n(665),nP=n(3049),nM=[{key:"jpg",label:"\u5BFC\u51FA\u4E3A JPG"},{key:"png",label:"\u5BFC\u51FA\u4E3A PNG"},{key:"svg",label:"\u5BFC\u51FA\u4E3A SVG"},{key:"json",label:"\u5BFC\u51FA\u4E3A \u6A21\u677F"}];function nF(){return(0,i.tZ)(ey.Z,{menu:{items:nM,onClick:function(e){var t=e.key,n=(0,J.o)(),r=n.sketch.fabritor_desc;switch(t){case"png":var i=n.export2Img({format:"png"});(0,U.Sv)(i,"png",r);break;case"jpg":var o=n.export2Img({format:"jpg"});(0,U.Sv)(o,"jpg",r);break;case"svg":var a=n.export2Svg();(0,U.Sv)(a,"svg",r);break;case"json":var l=n.export2Json();(0,U.Sv)(l,"json",r)}}},arrow:{pointAtCenter:!0},placement:"bottom",children:(0,i.tZ)(nO.Z,{type:"primary",icon:(0,i.tZ)(nP.Z,{})})})}var nA=c.Z.Content,nX={background:"#ddd",width:"100%",height:"100%",overflow:"hidden",flex:1},nE={display:"flex",flexDirection:"column",height:"100%"};function nT(){var e=(0,s.useRef)(null),t=(0,s.useRef)(null),n=(0,s.useRef)(),r=(0,a._)((0,s.useState)(null),2),u=r[0],d=r[1],f=(0,a._)((0,s.useState)(!1),2),v=f[0],p=f[1],g=(0,a._)((0,s.useState)(""),2),m=g[0],b=g[1],y=(0,s.useRef)(null),Z=(0,s.useRef)(null),w=function(e){var t,r,i,o=e.target;if(!o){null===(t=y.current)||void 0===t||t.hide();return}3===e.button?(o.id!==em.vH&&(null===(r=n.current)||void 0===r||r.canvas.setActiveObject(o)),setTimeout(function(){var e;null===(e=y.current)||void 0===e||e.show()},50)):null===(i=y.current)||void 0===i||i.hide()},k=function(e){var t,r,i=e.selected;i&&i.length?d(null===(t=n.current)||void 0===t?void 0:t.canvas.getActiveObject()):d(null===(r=n.current)||void 0===r?void 0:r.sketch)},x=function(e){var t=e.target,n=e.e;Z.current.show({left:n.pageX+16,top:n.pageY},"".concat(Math.round(t.angle),"\xb0"))},C=function(){Z.current.close()};return(0,s.useEffect)(function(){return setTimeout((0,o._)(function(){var r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:return[4,(r=new nH({canvasEl:e.current,workspaceEl:t.current,sketchEventHandler:{clickHandler:w,mouseupHandler:C,selectionHandler:k,rotateHandler:x,groupHandler:function(){var e;d(null===(e=n.current)||void 0===e?void 0:e.canvas.getActiveObject())}}})).init()];case 1:return i.sent(),n.current=r,(0,J.q)(r),p(!0),d(r.sketch),[2]}})}),300),function(){n.current&&(n.current.destroy(),n.current=null)}},[]),(0,i.tZ)(ef.Provider,{value:{object:u,setActiveObject:d,isReady:v,setReady:p,fxType:m,setFxType:b},children:(0,i.BX)(c.Z,{style:{height:"100%"},className:"fabritor-layout",children:[(0,i.tZ)(h.Z,{spinning:!v,fullscreen:!0}),(0,i.tZ)(nL,{ref:Z}),(0,i.tZ)(nF,{}),(0,i.BX)(c.Z,{children:[(0,i.tZ)(e9,{}),(0,i.BX)(nA,{style:nE,children:[(0,i.tZ)(t3,{}),(0,i.tZ)(eZ,{ref:y,object:u,children:(0,i.tZ)("div",{style:nX,ref:t,className:"fabritor-workspace",children:(0,i.tZ)("canvas",{ref:e})})})]})]})]})})}function nV(){return(0,i.tZ)(nT,{})}}}]);